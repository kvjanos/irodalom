Original Article

Three-Dimensional Segmentation of Nuclei and Mitotic Chromosomes for the Study of Cell Divisions in Live Drosophila Embryos
Rambabu Chinta,1* Martin Wasser1,2*
 Abstract Drosophila embryogenesis is an established model to investigate mechanisms and genes related to cell divisions in an intact multicellular organism. Progression through the cell cycle phases can be monitored in vivo using fluorescently labeled fusion proteins and time-lapse microscopy. To measure cellular properties in microscopic images, accurate and fast image segmentation methods are a critical prerequisite. To quantify static and dynamic features of interphase nuclei and mitotic chromosomes, we developed a three-dimensional (3D) segmentation method based on multiple level sets. We tested our method on 3D time-series images of live embryos expressing histone-2Av-green fluorescence protein. Our method is robust to low signal-to-noise ratios inherent to high-speed imaging, fluorescent signals in the cytoplasm, and dynamic changes of shape and texture. Comparisons with manual ground-truth segmentations showed that our method achieves more than 90% accuracy on the object as well as voxel levels and performs consistently throughout all cell cycle phases and developmental stages from syncytial blastoderm to postblastoderm mitotic domains. ' 2011 International Society for
Advancement of Cytometry

1

Bioinformatics Institute, Agency for Science, Technology and Research (A*STAR), Singapore 138671, Republic of Singapore Department of Biological Sciences, National University of Singapore, Republic of Singapore

2

Received 21 April 2011; Revision Received 19 July 2011; Accepted 6 October 2011 Additional Supporting Information may be found in the online version of this article. *Correspondence to: Rambabu Chinta. E-mail: chinta@bii.a-star.edu.sg or Martin Wasser. E-mail: martinw@bii. a-star.edu.sg. Bioinformatics Institute, Agency for Science, Technology and Research (A*STAR), 30 Biopolis Street, #07-01 Matrix, Singapore 138671, Republic of Singapore. Published online in Wiley Online Library (wileyonlinelibrary.com) DOI: 10.1002/cyto.a.21164 © 2011 International Society for Advancement of Cytometry

 Key terms 3D nuclear segmentation; live cell imaging; confocal microscopy; Drosophila; embryogenesis; cell cycle; mitosis; histone-GFP

INTRODUCTION
Cell proliferation and its regulation play crucial roles in development and disease (1). Cell cycle progression and mitosis are controlled by genes that are highly conserved throughout eukaryotes. Numerous genetic screens in yeast, mammalian, and Drosophila tissue culture have led to the identification of novel genes involved in this process. Phenotypic analysis in most of the studies has been based on endpoint assays of fixed cells. The drawback of these assays is that they can miss transient mitotic abnormalities and cannot easily distinguish between primary effects of gene knockdowns or drug treatments and their secondary phenotypic consequences (2). Time-lapse microscopy of live cells can overcome these weaknesses by helping to measure dynamic features. It has been applied to detect cell division genes on a genome-wide scale (3) or to dissect particular aspects of the mitotic machinery, such as the kinetochores (4). Drosophila is a powerful model system to study the cell division cycle in the context of a developing multicellular organism (5). Embryos, due to their transparency, and the availability of fluorescent reporter genes are especially amenable to imaging of division cycles in vivo. Fluorescently tagged fusion proteins enable visualization of the dynamics of chromosomes, microtubules, and other subcellular compartments (6–8). Early embryos show two types of division cycles. Following fertilization, all 13 synchronous nuclear divisions occur in a joint cytoplasm or syncytium. Once cellularization completes during interphase of cycle 14, cell division

Cytometry Part A  00A: 000À000, 2011

ORIGINAL ARTICLE
activity resumes in mitotic domains, clusters of synchronously dividing cells (9). As in vivo studies of immortalized cell cultures have shown, quantitative analysis of time-lapse movies data can provide new insights into the function of cell division genes. To accomplish this type of quantification in animal models like Drosophila, accurate and fast three-dimensional (3D) image segmentation algorithms are a prerequisite for downstream feature extraction, tracking, and phenotypic classification (10,11). However, the segmentation of cells, nuclei, and other subcellular structures in images of live tissues encounters a variety of challenges. Fast imaging and light attenuation in deep tissue sections can lead to low signal-to-noise ratios (SNRs) and weak contrast that affect the detection of contours. The dense packing of cells may cause the problem that multiple nuclei are detected as clumps rather than individual objects (12). The increasing interest in quantitative microscopy has given rise to a diverse range of automated 3D nuclear segmentation algorithms. Segmentation methods based on global thresholding (13) are unsuccessful for images that show low SNRs and/or low contrast foreground and background. An adaptive thresholding-based method was developed for the tracking of nuclei in early zebrafish development (14). This method is based on the stepwise increase of threshold levels and relies on a priori knowledge about minimum nuclear diameter and morphology. Watershed-based methods are useful for images that require the splitting of merged nuclei. However, they are prone to oversegmentation and require complex postprocessing. A local maximum approach for nuclear identification related to the watershed algorithm was used for cell lineage tracing in C. elegans (15). A semiautomatic segmentation method based on watershed transform has been developed to identify nuclei in 3D images of C. elegans to generate a 3D digital atlas (16). Model-based segmentation methods have demonstrated the highest segmentation accuracy; however, they rely on a priori model of the expected nuclei morphology (17,18). To combine the advantages of different basic methods, various hybrid methods were proposed. A gradient flow tracking algorithm was used to identify the nuclei in 3D image stacks of C. elegans and zebrafish embryos (19). A combination of graph cuts and multiscale Laplacian of Gaussian (LOG) was used to detect cell nuclei in histopathology images (20). A hybrid blob-slice model approach first detects nuclear slices in 2D images and then fits these slices to a 3D model (21). Moreover, various level set-based methods have been proposed for nuclear segmentation. Level sets represent deformable models of contours or surfaces, which evolve with a speed force that depends on the geometric properties and external energies of image regions (22,23). Level sets handle arbitrary changes in contour topology and, therefore, are well suited to segment images with an unknown number of objects. To segment and track cells in 3D, a multilevel set method based on coupled active surfaces with or without edges was introduced (24). A regionbased PDE method was introduced to segment and count cells in 3D images of vertebrate embryogenesis (25). A fast level set method was applied to the segmentation of chromosomes in
2

2D time series images of early Drosophila embryos (26). If nuclei have significantly different intensity statistics, single level set functions may lead to inaccurate segmentation results. This limitation can be overcome by using multiple level sets (MLS; Refs. 24, 27, and 28). Despite their ability to find contours in images lacking distinct gradient, level set methods are considered impractical for large-scale applications as they are computationally expensive and depend on the accuracy of the initial seed selection (24,27). Our interest is the quantitative analysis of division cycles in live Drosophila embryos expressing the fluorescence reporter histone-2Av-green fluorescence protein (GFP). The sources of our data are 3D time-series images acquired by high-speed laser scanning confocal microscopy (LSCM). To be able to extract and measure features relevant for the study of division cycles, we developed a fully automated 3D level set-based segmentation method for both interphase nuclei and mitotic chromosomes. To achieve sufficient accuracy for volumetric measurements and satisfactory processing speed for very large image datasets, we combined ideas of existing methods in a novel fashion. Conventional level set-based segmentation is widely regarded impractical for 3D microscopy because of its computational complexity. Our method, which is related to a narrow-band (NB) approach for real-time video tracking (29), applies the level set concept in a more efficient way to allow segmentation of 3D image stacks. We avoid the time-consuming reinitialization of level sets by representing surfaces with integer-valued level set functions and limiting the width of NBs to one voxel. As manual initialization of level sets is unproductive for nuclear segmentation in densely populated tissues, we included K-means clustering followed by an Expectation and Maximization (EM) algorithm to automatically detect foreground regions (30). On level set initialization, we performed a three-step strategy for unidirectional surface evolution that is different from the bidirectional and single-step surface evolution in most (if not all) other studies. In the first step (object detection), surfaces can only shrink, whereas in the third step (region growing), surfaces can only expand. The local intensity profile and curvature control the speed function F that regulates surface evolution. An intervening second step serves to split objects and detect seeds. We designed a queue-based data structure to support processing of either interior object voxels adjacent to the shrinking (Step 1) or exterior background voxel adjacent to the growing surface (Step 3). Our approach provides a convenient stopping criterion, as curve evolution stops once voxels in queue do not change any more. In addition, to prevent the merging of evolving surface fronts originating from different seeds, we introduced watershed labels. As chromatin displays dynamic changes in intensity profiles due to DNA condensation and decondensation, we adopted a multilevel set approach to allow local optimization of surface evolution. The multilevel set approach assigns one level set function per cell and was introduced in Refs. 24 and 27. In contrast to the previous study in which the number of level set functions is fixed after initialization, our approach updates the number of level sets in each iteration of the surface evolution during object detection. We
3D Segmentation of Nuclei and Mitotic Chromosomes

ORIGINAL ARTICLE
show that our method is accurate throughout all cell cycle phases and developmental stages from the syncytial blastoderm until the gastrulation. Although most existing 3D segmentation methods for tissues are aimed at detecting the centroids of nuclei, we also focused on the accuracy of volume detection, which is crucial to monitor cell cycle progression. We present a workflow for its validation in which segmentation performance is evaluated according to the cell cycle phase. As most cells are in interphase, an overall good performance can mask a poor segmentation of transient mitotic phases. Furthermore, we introduced tuning parameters to shift the zero-level sets, allowing the users to minimize the discrepancy between manual and machine segmentations. We implemented the method as standalone software that is freely available for academic research (the software can be downloaded from the following website: http://web.bii.a-star.edu.sg/archive/ MLSCellNucleiDetection/). calculated based on microscopic parameters. On deconvolution, datasets were saved in ICS format and used for 3D image stack segmentation. To test the effect of deconvolution on the performance of our algorithm, we repeated the segmentation of some image stacks without prior deconvolution. As we did not observe a dramatic loss in segmentation quality (Supporting Information Fig. 1), deconvolution appears to be a dispensable preprocessing step for confocal microcopy images used in this study.

ALGORITHMS AND IMPLEMENTATION
Preprocessing Serial optical sections produced by confocal microscopy tend to suffer from attenuation of fluorescence signals in deeper tissue layers. To compensate for uneven illumination within the same image stack, we used a published method (33) that normalizes pixel intensity relative to the optical slice that shows the highest mean intensity. Within the 30 lm of tissue depth, we estimated the light attenuation to be $30% between top and bottom nuclei. The low laser power of under 1% did not result in photobleaching. To reduce background noise, we applied median filtering to the normalized image stack using a 3D window of size 3 3 3 3 3 voxels. Overview of 3D MLS Segmentation Method for Cell Nuclei We developed an automated 3D MLS segmentation method that preserves the surfaces of cell nuclei and is robust against imaging artifacts inherent to confocal laser scanning microscopy. Figure 1 illustrates the four major steps of the 3D MLS segmentation method. The first step consisted of background and foreground detection using the K-means Classifier (34) followed by the weighted EM algorithm (30). We chose the detected foreground regions as the initial level set function and determined the statistics of intensity in the background and foreground regions. In the second step, we detected 3D objects based on the concept of multiple NB level sets. The third step aims to separate merged nuclei through the erosion of 3D objects into seeds. Single nuclei were reduced to single seeds, whereas clumps of merged nuclei were transformed into multiple seeds. We chose this approach because splitting based on watershed transformation based on Euclidian distance maps is prone to oversegmentation, fails to smooth the curvature of the surface, and is computationally more complex. In the fourth step, we performed region growing to restore the 3D objects using seeds as inputs. A detailed description of the major steps is provided below.

MATERIALS AND METHODS
Sample Preparation and Microscopy To visualize chromosomes in live Drosophila embryos, we used the line His2AvDGFP (31) that expresses histone2Av tagged to GFP (henceforth referred to as histone-GFP). Embryos of 0-2 hours were dechorionated for 2 min using a 50% bleach solution. The dechorionated embryos were placed on an uncoated 32-mm-diameter glass bottom dish (MatTek, Ashland, Massachusetts) and covered with a solidified layer of 0.8% agarose to prevent dehydration during the course of imaging. This sample preparation did not affect viability as the embryos developed to the larval stage. Time-lapse imaging of the embryos was performed with a high-speed, line-scanning Zeiss 5 Live (Carl Zeiss, Jena, Germany) confocal laser scanning inverted microscope using a 633/1.4 oil DIC Plan-Apochromat objective. The 3D stacks, consisting of 66–70 slices of 1,024 3 1,024 pixels, were recorded at 55- to 60-s intervals for periods of up to 3 h. The voxel dimensions in x/y/z were 0.1 3 0.1 3 0.44 lm. The excitation wavelength of 489 nm was used at 0.5–1% laser power in combination with an emission long-pass filter of 505 nm. The slit size was set to 10 lm, and the optimal sampling in z of 0.44 lm was suggested by the Zeiss 5 Live acquisition software. The time-lapse imaging did not result in phototoxicity in the embryos as they developed to become larvae after recording was terminated. 3D reconstructions of interphase nuclei showed round shapes, indicating that our image setup did not introduce discernible spherical aberrations. Image Restoration The 4D confocal microscopy datasets were saved in the LSM format (Carl Zeiss), converted into the Image Cytometry Standard (ICS) format (32), and deconvolved using Huygens Professional (version 2.10.0, Scientific Volume Imaging, Hilversum, The Netherlands). We used the Classic Maximum Likelihood Estimation algorithm for image restoration, with the quality factor set to 0.01 and maximum number of iterations set to 1,000. We used a theoretical point-spread function
Cytometry Part A  00A: 00À00, 2011

Background/foreground detection. Deformable models, like level sets, tend to perform more efficiently when they are initialized close to the desired solution. To initialize the level set functions, we propose a background/foreground detection method based on K-means classification (34) and a subsequent weighted EM algorithm (30) that partitions 2D image slices into background and foreground regions. We used a two-class Gaussian mixture distribution to describe the pixels in the image stack as the combination of background and
3

ORIGINAL ARTICLE

Figure 1. A: Overview flowchart of the image analysis steps. B: Flow chart illustrating the major steps of the 3D MLS segmentation method for cell nuclei. C: Schematic flow diagram of 3D objects detection. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]

foreground classes. Prior to the iterative EM algorithm, we initialized the parameters of the mixture model under guidance of K-means clustering to prevent the log-likelihood function from falling into a local minimum. The EM steps were iterated until convergence and labels of voxels (background or foreground) were chosen using maximum of a posteriori estimates (see Section 1.1 of Supporting Information for more details).

3D object detection. Step 2 of the nuclear detection method is based on the concept of multiple NB level sets and consists of two sequential steps: level set initialization and adaptive MLS active surface modeling (Fig. 1C). Cell nuclei in the different phases of the cell cycle differ in terms of shape, texture, and intensity profile (Fig. 2). To deal with the heterogeneity of
4

image objects, we decided to assign separate level set functions to each image object such that surface evolution can be controlled by local intensity and curvature. The goal was to identify surfaces that maximize the variance between interior and exterior (background) intensity distribution for all objects. On background/foreground detection, all foreground voxel share the same label. Hence, the first round of recursive surface modeling is driven by the global intensity profile of the entire foreground. Next, connected component labeling initializes objects, assigns unique labels, and computes individual Gaussian models and optimal intensity thresholds. From now on, surfaces evolve independently from one another in an iterative manner. At the end of each cycle, 3D connected component labeling updates the numbers and labels of objects and recomputes their respective intensity features. The updating step initializes new objects whenever surfaces split (Supporting
3D Segmentation of Nuclei and Mitotic Chromosomes

ORIGINAL ARTICLE
of MLS was introduced in a previous study (27) for the purpose of segmentation and tracking. Once initialized, the number of level set functions stays constant during surface evolution of object detection. By contrast, in our method, the number of level sets can change. To identify and update the labels of 3D objects during surface evolution, we applied a fast 3D connected component labeling approach. Each 3D connected component is scanned in a breadth-first order by using a queue-based data structure. Each visited voxel corresponding to the same connected component is assigned the same label. This approach requires only one raster scan of the image for the entire computation (see Section 1.3 of Supporting Information for more details). Modified NB level sets. The basic idea of NB level sets is to restrict the updating of the level set functions to a subset of points in the neighborhood of the evolving front (35). The NB has to be updated in each iteration where it searches for the closest front point over the entire fixed NB for computing front driving force. The most time-consuming step of NB methods is level set reinitialization. The time complexity of the NB method is O(dn4), where n represents the number of surface points and d the width of the NB. The high computational complexity makes the NB approach impractical for high-throughput 3D segmentation in biological volume data. Similar to the fast twocycle method (36), our NB approach avoids the time-consuming reinitialization step. Both algorithms evolve NB level sets that are one voxel wide without the need to solve partial differential equations (PDEs). In addition, both methods use integervalued level set representations. The difference of our approach is that we combine the intensity-dependent speed function with curvature flow to smooth the active surface. In our approach, we updated the level sets in the immediate 3D neighborhoods (26 connected) of the deforming front points and defined an appropriate speed function F that can direct the evolving surface to the desired object boundary. To accelerate the computation, we used a queue-based front propagation method that limited updating of the level set functions to voxels next to the surface front that were inside the objects region and, hence, did not belong to the background. We used an implicit representation of the surface S as the zero-level set of a higher dimensional time-varying function F (X, t) 5 0, S(t) 5 {X [ R3 |F(X, t) 5 0}. The function F denotes a 4D surface defined by F (X, t) 5 Æd, where d was the unit distance from X to the surface front S (21 for inside the object surface and 11 for the outside the object surface). The surface evolution is represented by the following equation: @UðSÞ @S @U @U ¼ Á rU þ ¼0 ) ¼ ÀF jrUj: @t @t @t @t ð1Þ

Figure 2. A: Images of histone-GFP-labeled nuclei reveal cell cycle dependent difference in size, shape, texture, and intensity. B: Intensity profiles of nuclei vary between cell cycle phases. The box plots were derived from voxel intensities of 15 samples each of early and late interphase nuclei and 20 samples of each mitotic phase. The samples were selected from 10 image stacks recorded during the syncytial blastoderm. The numbers of voxels per class were as follows: later interphase, 2.5 3 105; early interphase, 1.3 3 105; prophase, 2.8 3 105; metaphase, 2.5 3 105; anaphase, 9.8 3 104; telophase, 7.5 3 104; image background, 6.3 3 106. C: Changes in mean and standard deviation of intensity of a single nucleus during mitosis of NC13. The scale bar in the panel showing telophase represents 5 lm and applies to all other panels in (A). [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]

The 4D surface deforms iteratively according to the speed function F. Modified speed function F. Speed functions are based on local curvature and intensity. Their design plays a critical role in the accuracy of the surface evolution. The formulation of the modified speed function is given as follows:
5

Information Fig. 2a). Surface evolution is aborted once no surface points have changed their level set function or a maximum number of user-defined iterations is reached. The idea
Cytometry Part A  00A: 00À00, 2011

ORIGINAL ARTICLE
F ¼ R À eK; ð2Þ Seed detection. An iterative conditional surface erosion shrinks 3D objects using an intensity threshold, Ti 5 li 2 DkM 3 ri. Here, DkM is the constant scale factor, whose value needs to be optimized as outlined in the Validation of Image Segmentation section. Subsequently, false positive objects such as debris are filtered out using a volume threshold. The pseudo-code of the seed detection procedure can be found in Section 1.4 of Supporting Information. Watershed transformation based on Euclidian distance maps was not selected as an alternative method as it tends to be prone to oversegmentation, fails to smooth curvature, and is computationally more complex. 3D seeded region growing. The 3D seeds are used to initiate region growing. Similar to the 3D objects detection in Step 2, each growing region or 3D object is represented by its own level set function. To prevent the fusion of regions originating from different seeds, we introduced ‘‘watersheds’’ to label voxels at the interface between different 3D objects. We used a FIFO queue for recursive 3D region growing in breadth-first order. The queue contains the outer band points, which are defined as background points (F 5 1) having at least one seed or object point (F 5 21) as a neighbor. The outer band points p [ DI are dequeued from queue Q one at a time and their speed forces F are computed. If the force F at point p is greater than zero and borders a single object, p is assigned the label of that object. If p has two or more objects with different labels in its immediate neighborhood p, then it is labeled as a watershed voxel. In each iteration, we update the Gaussian models of background and object regions and compute the 0 0 optimal threshold Ti of each growing 3D region i, Ti 5 Ti 1 DkRG 3 ri. Note that DkRG is a user-defined fine-tuning parameter for the region growing process that is selected based on the receiver operating characteristic (ROC) curve (see Results section). The region growing process is repeated until no more changes happen to the surface front points. The pseudo-code of the modified seeded region growing process can be found in Section 1.5 of Supporting Information. On completion of region growing, we apply an isotropic and discrete Gaussian shape filter of size (3 3 3 3 3) to the 3D level sets to smooth the surface points.
Validation of Image Segmentation Qualitative evaluation of image segmentation quality was performed using three complementary visualization techniques. First, contours were projected on raw image of individual optical sections. Second, we extracted silhouette contours of all 3D objects and superimposed them onto maximum intensity projections (MIPs) of the 3D image stack (Supporting Information Fig. 3a). Third, we extracted and rendered isosurfaces (Supporting Information Fig. 3b) using the visualization tool kit (39). Quantitative evaluation of segmentation performance was carried out by comparing the output of the MLS method to a manually created ground truth (GT) on the object and voxel level. GT was specified and verified by the two authors using a custom-made segmentation editor that is based on
3D Segmentation of Nuclei and Mitotic Chromosomes

where R is a signed step function (11 for object region and 21 for background) that makes the object surface inflate or deflate. Let us consider a 3D image stack I whose domain is denoted as DI & Z3 and I : DI ? N as a function assigning an integer value to each voxel p [ DI. The signed value R(p) at voxel p [ DI can be obtained by the following equation:  RðpÞ ¼ 1 If ðIðpÞ > Ti0 Þ Ti0 ¼ Ti þ Dk3ri ; ; i ¼ LðpÞ; object label at p: À1 Otherwise ð3Þ where I(p) denotes the intensity value at voxel p. The threshold Ti is an optimal value between the background model N(lB, rB2) and the candidate object model N(li, ri2), which is computed based on the iterative thresholding method (37). The shifted 0 threshold Ti is derived by modulating Ti using the offset Dk 3 ri, where Dk denotes a user-defined threshold shift factor and ri the standard deviation of the intensity distribution in candidate object i. Dk was optimized using our validation strategy outlined in the section ‘‘Validation of Image Segmentation.’’ We introduced a viscosity term 2eK that depends on the curvature K and helps to smooth the surface by reducing the magnitude of the speed force. Here, K represents the mean curvature of evolving surface S, and e denotes a positive constant (e [ [0, 1]) curvature term weight that controls the strength of mean curvature. e was chosen based on visual inspection. A value of 0.2 met our aim to produce contours that were neither too jagged nor too smooth. The mean rU curvature K of surface can be formulated as K ¼ r Á jrUj (Ref. 38; Section 1.2 of Supporting Information). Queue-based multiactive surface evolution. We used a FIFO queue for recursive surface evolution in breadth-first order from initial foreground surface front points (Supporting Information Fig. 2b). First, we initialized the 3D level sets F with 11 for background and 21 for foreground region and then initialized the FIFO queue Q with the foreground points (F 5 21), which have at least one background neighbor point (F 5 1). Point p [ DI is dequeued from queue Q one at a time, and its speed force F(p) is calculated as given in Eq. (2). Our level set-based surface evolution is based on the sign of speed forces. If the force F(p) is less than zero, the candidate point p becomes background [the sign of the level set changes to F(p) 5 1] and all its neighboring object points that have level set values of 21 and the same object label are inserted into the queue Q for recursive active surface evolution. In each iteration, all points in the queue Q are processed, labels of 3D connected components are updated, the Gaussian models of the intensity distribution in object and background 0 regions are determined, and the optimal threshold values Ti between object regions and background are updated. Following background/foreground detection and object detection, each 3D object is assigned its own level set function F along with a unique identifier (see Sections 1.2 and 1.3 of Supporting Information for more details).
6

ORIGINAL ARTICLE
thresholding (see Section 1.6 of Supporting Information for more details). Our recorded stacks spanned a tissue depth of 30 lm (70 3 0.44 lm). Because objects in deeper regions might be incompletely recorded and, in single-photon LSCM, deeper sections are affected by light attenuation and scattering, we only scored objects whose centroids had z-coordinates of 25 lm or less. We compared our segmentation method to a variant of Otsu’s adaptive thresholding (13) and the 64-bit version of the FARSIGHT nuclear segmentation (40), which is based on a combination of graph cuts and multiscale LOG. We did not use methods that require commercial software licenses, for example, Matlab. Adaptive thresholding consisted of median filtering (window size 7 3 7), calculating Otsu thresholds for all Z-sections individually, and applying the maximum threshold to all slices. Calculating a threshold for the whole stack or applying individual thresholds to the corresponding slices produced inferior results to the first approach. The FARSIGHT tool was developed for the 3D segmentation of fluorescently labeled nuclei and does not require any parameter adjustment.
Implementation We implemented our 3D MLS segmentation algorithm in C11 using the OpenCV (41) computer vision library. A standalone application with graphical user interface (see Section 1.7 and Fig. 4 of Supporting Information) was built using the QT user interface software development kit, the Visualization tool kit (39), and the libics v1.5 reference library for reading and writing multidimensional files of the ICS format (32). This application either performs segmentation of individual image stacks with subsequent visualization or batch processing of 3D stacks corresponding to multiple time points. A user manual describing strategies for tuning segmentation parameters can be found in Section 3 of the Supporting Information. Validation To quantify the performance of our automated segmentation method, we manually segmented the 52 test image stacks to generate a GT dataset comprising 8,645 nuclei in various phases of the cell division cycle (Table 1). We performed segmentation of the test set using the following parameter values that we chose based on visual inspection. The offset value of zero-level sets for object detection DkO and the scale factor for seed detection DkM were set to 0.5, whereas the offset value for region growing DkRG was set to 0.2. On the object level, our method correctly identified more than 99% (8,574) of all nuclei. The detection rate was consistent through all cell cycle and developmental phases. No object was missed, and we observed 28 cases of merged objects that were mostly interphase nuclei in NC13 and early cellular blastoderm. Seventeen objects were fragmented, most of which were groups of mitotic chromosomes. In addition, we observed false detection of 43 spurious objects, which were neither interphase nuclei nor mitotic chromosomes. To estimate the performance of this method in measuring volume, we also determined voxel-level accuracy using the Fmeasure [F 5 2 3 P 3 R/(P1R)], which combines precision (P) and recall (R) of segmentation (see Section 1.6 of Supporting Information). The average F-measure was 90% and consistent through all cell cycle and developmental phases. Using the selected parameters, the average volume was overestimated by 7% relative to the GT. To explore the influence of the region growing parameter DkRG on segmentation accuracy and to further improve the F-measure, we varied its value from 20.5 to 11.0 (Fig. 4). As expected, DkRG and estimated volume were inversely correlated (Fig. 4A). Using the F-measure and the ROC curve, we were able to fine tune the region growing parameter to minimize the variance to the GT specified by the human expert. In our case, values of 10.2 produced the highest accuracy. Negative values caused the surface to grow into the background, resulting in an overestimation of volume, whereas higher positive values (e.g., 11.0) led to an underestimation by more than 20%. Object- and voxel-based segmentation performance for the GT image dataset using the parameters DkO 5 0.5, DkM 5 0.5, and DkRG 5 0.2 are shown in Tables 1 and 2. The SNRs in histone-GFP-expressing embryos depend on the developmental stage and affect segmentation quality. In NC11 and before, stronger cytoplasmic fluorescence due to histone-GFP-containing lipid droplets (42) caused the bleeding of detected regions into the cytoplasm using the parameters DkO 5 0.5, DkM 5 0.5, and DkRG 5 0.2 (Supporting Information Fig. 5a, right panel). In contrast, from NC12 onward, nuclear segmentation showed satisfactory performance using the same parameter set (Supporting Information Fig. 5b). The ratio of the mean intensity in foreground versus background regions (cytoplasm inside embryos) was estimated to be 1.8 in NC11, 2.5 in NC12, and 3.1 in NC13 (the three measurements were performed in interphase nuclei at a depth of 15 lm). The increase in the object detection parameter DkO from 0.5 to 1.5 helped to improve nuclear segmenta7

RESULTS
We designed an automated 3D MLS segmentation method to detect interphase nuclei and mitotic chromosomes in 3D images of live Drosophila embryos acquired by LSCM. We tested our segmentation method on 52 image stacks of embryos expressing histone-GFP in different developmental stages and cell cycle phases. The test set contained 30 stacks recorded during the synchronized divisions of the syncytial blastoderm (nuclear cycles [NCs] 11–13), five during the cellular blastoderm stage and 17 during the cell divisions of the postblastoderm stage. We embedded the 3D segmentation into a graphical user interface that permitted a rapid qualitative assessment of segmentation quality using two visualization techniques. First, silhouette contours were extracted from 3D objects (Fig. 3C) and drawn on top of MIPs of the image stack. This technique was particularly useful in identifying object fusions and fragmentations. The other visualization technique was isosurface rendering of segmented nuclei in random colors (Fig. 3B). Visual assessment showed that our method can adapt to the dynamically changing shapes in mitosis and the transition from round to columnar shape during the cellularization of the cellular blastoderm stage.
Cytometry Part A  00A: 00À00, 2011

Figure 3. Automatic segmentation of cell nuclei in a histone-GFP expressing live Drosophila embryo recorded at 55-s intervals from NC11 until the postblastoderm stage. The method is able to detect interphase nuclei and mitotic chromosomes: (A) maximum intensity projection (MIP) volume rendering of the original image stack; (B) isosurface views of segmented cell nuclei in random colors; and (C) silhouette contours of segmented cell nuclei projected on the MIP of image stacks. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]

ORIGINAL ARTICLE
To test if our method can be applied to monitor progression through the nuclear and cell division cycles, we tracked wild-type nuclei for 110 time points at 55-s intervals from NC11 until the postblastoderm stage and measured their volume (Fig. 5). Consistent with chromatin condensation at the onset of mitosis, we observed threefold to fourfold volume decreases from 200–240 lm3 at late interphase down to 60– 70 lm3 at metaphase. Separation of sister chromatids at anaphase leads to a reduction of volume by half. Decondensation of chromatin on exit from mitosis is reflected by a rapid increase of the measure nuclear volume.
Benchmarking and Performance To further evaluate our segmentation method, we compared it with a variant of Otsu’s adaptive thresholding (13) and the automated nuclear segmentation module of the FARSIGHT toolkit (20,40). Our intention was to assess how existing open-source tools developed for different 3D images of fluorescently labeled nuclei performs on our data. However, we like to emphasize that these comparisons can never be totally fair as most 3D segmentation methods for microscopy, like ours, were optimized for a particular set of images. We performed tests on two different stacks of 1,024 3 1,024 3 70 voxels (x/y/z), one showing 283 interphase nuclei during the early cellular blastoderm (Figs. 6A–6C) and the other showing 181 postcellular blastoderm cells in different phases of the cell cycle (Figs. 6D–6F). A major challenge in nuclear segmentation is the crowding of nuclei in tissues that can lead to the fusion of objects, as can be seen in the output of the adaptive thresholding method (Fig. 6B). Dedicated nuclear segmentation methods like MLS (Fig. 6A) and FARSIGHT (Fig. 6C) avoid this problem. Although both methods performed equally well in the detection of interphase nuclei, our method appeared less prone to splitting of condensed mitotic chromosomes (compare arrows in Figs. 6D and 6F). This slight oversegmentation of the FARSIGHT method might be the result of increased seed detection due to spatially distinct cluster of condensed chromatin. The quantitative assessment of segmentation outputs revealed that MLS method had advantages with respect to robustness of segmentation performance as it showed less variation when we compared object and voxel base accuracy in different time points of the same dataset (Supporting Information Table 1 and Fig. 7). To test if our method was suitable for other animal models and fluorescent microscopes, we applied our method to a 3D image stack of a histone-GFP-labeled zebrafish embryo acquired by light sheet microscopy (14). Visual inspection demonstrated satisfactory segmentation performance on an image stack consisting of 118 slices of 972 3 915 size (Supporting Information Fig. 8). Quantitative evaluation on the objects level revealed that our algorithm detected 81% of all nuclei in the zebrafish GT set (see Section 2.1 of Supporting Information). On a desktop PC with an Intel i7 core CPU at 3.07 GHz, Windows 7 OS, and 12 GB RAM, 80 time points (stacks of 1,024 3 1,024 3 70 voxels) distributed over eight processes were processed in 122 min or $1.5 min per stack. The individual stacks mentioned above (Fig. 6) were processed in 179
9

Figure 4. The performance of the MLS segmentation method depends on the region growing parameter DkRG. A: The relative volume of segmented cell nuclei with respect to the ground truth is inversely correlated with DkRG. The voxel-level accuracy or F-measure (B) in conjunction with the receiver operating characteristics (ROC) curve (C) can be used to select a suitable parameter set. The parameters DkO and DkM were set to a constant value of 0.5. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]

tion in NC11 (Supporting Information Fig. 5a, left panel). A more detailed analysis of the influence of DkO and DkM on object detection is shown in Supporting Information Figure 6.
Cytometry Part A  00A: 00À00, 2011

ORIGINAL ARTICLE
Table 1. Object-level accuracy
ERROR CELL CYCLE NUMBER OF NUCLEI CORRECT MISSING SPURIOUSa PHASE (GT; DEPTH, 25 lm) SEGMENTATION MERGED SPLIT FALSE POSITIVES FALSE NEGATIVES ACCURACY (%)

DEVELOPMENTAL STAGE

Syncytial blastoderm (30 stacks) Inter Pro Meta Ana Telo Cellular blastoderm (5 stacks) Postblastoderm mitotic domains (17 stacks) Inter Inter Pro Meta Ana Telo

Overall

2,631 234 595 324 382 4,166 1,211 2,582 141 209 211 125 3,268 8645

2,607 234 593 317 378 4,129 1,203 2,576 136 204 203 123 3,242 8574

12 0 0 2 2 16 4 3 0 1 3 1 8 28

0 0 2 3 0 5 2 0 5 3 2 0 10 17

9 2

0 0

32 43

0 0

99.08 100 99.66 98.45 98.9 99.12 99.34 99.76 96.5 97.6 96.2 98.4 99.2 99.17

The values of parameters DkO, DkM, and DkRG are set to 0.5, 0.5, and 0.2, respectively. The minimum size of ground truth objects was set to 2,000 voxels and maximum depth to 25 lm. a the number of cases were neither interphase nor mitotic chromosomes.

and 160 s. We expect that runtime can be further reduced by multithreading and code optimization.

DISCUSSION
We have developed a 3D segmentation method to measure and track interphase nuclei and mitotic chromosomes progressing through the cell cycle phases of Drosophila embryogenesis. Our design had to address a variety of applicationspecific requirements. The method had to detect a heterogeneous population of objects, be accurate in volume measurements as well as object counting, robust to low SNR inherent to high-speed confocal microscopy, and fast enough to cope with immense amounts of image data produced by 3D time-

lapse microscopy. Our segmentation method was based on the concept of MLS in which surfaces of multiple objects evolved independently to adapt to regional intensity profiles. The property was helpful because the distribution of histone-GFP undergoes dynamic cell cycle dependent changes, resulting in 3D objects of variable size, shape, texture, and intensity profile. Performance evaluation on the object and voxel level showed consistent segmentation accuracy throughout all cell cycle phases. The comparison with published 3D nuclear segmentation tools showed that, although all methods performed similarly with respect to interphase nuclei, our method displayed an advantage in segmenting mitotic chromosomes as an alternative method was prone to oversegmentation. More-

Table 2. Voxel-level accuracy
DEVELOPMENTAL STAGE CELL CYCLE PHASE NUCLEI SCORED PRECISION (P) (%) RECALL (R) (%) ACCURACY (%) (Æ SD) RELATIVE VOLUME DIFFERENCE (%) (Æ SD)

Syncytial blastoderm (30 stacks)

Interphase Prophase Metaphase Anaphase Telophase Interphase Interphase Prophase Metaphase Anaphase Telophase

Cellular blastoderm (5 stacks) Postblastoderm mitotic domains (17 stacks)

Overall

2,607 234 593 317 378 4,129 1,203 2,576 136 204 203 123 3,242 8574

88.21 90.67 93.19 91.7 91.29 89.64 89.72 88.97 91.88 88.82 90.65 94.5 89.4 89.6

94.83 94.84 89.73 92.32 92.27 93.65 95.0 93.56 88.38 89.87 89.82 90.32 92.74 93.48

90.76 (Æ6.14) 92.29 (Æ3.42) 91.08 (Æ2.75) 91.78 (Æ2.23) 91.23 (Æ4.24) 91.08 (Æ5.25) 91.64 (Æ4.29) 90.38 (Æ6.22) 89.16 (Æ5.65) 88.47 (Æ4.14) 89.48 (Æ3.94) 91.98 (Æ3.04) 90.19 (Æ5.89) 90.8 (Æ5.42)

8.53 (Æ18.05) 4.62 (Æ13.35) 23.37 (Æ13.28) 0.18 (Æ12.42) 1.97 (Æ16.74) 5.3 (Æ17.28) 15.48 (Æ12.27) 7.189 (Æ21.91) 23.4 (Æ21.38) 2.45 (Æ21.31) 0.48 (Æ20.52) 23.78 (Æ13.28) 5.6 (Æ21.74) 6.74 (Æ20.95)

The values of parameters DkO, DkM, and DkRG were set to 0.5, 0.5, and 0.2, respectively.

10

3D Segmentation of Nuclei and Mitotic Chromosomes

ORIGINAL ARTICLE
Level set approaches are generally considered impractical for large-scale 3D nuclear segmentation due to ineffective initialization, high computational complexity, and inability to split clusters of merged nuclei (40). Our implementation overcomes many of these shortcomings. The initialization of level sets based on K-means clustering and weighted EM led to high accuracy in object detection. The NB approach-based surface evolution reduced execution speed to a level that is acceptable for long-lasting 3D time lapse experiments. In addition, the object erosion following initial object detection helped to split clusters of merged nuclei. Coinciding with a dense packing of nuclei at the end of the syncytial blastoderm, we observed a small proportion of merged objects. Because of the lack of intensity gradients between adjacent nuclei, shapebased splitting methods are a conceivable way to separate fused objects (43). The precision of volume measurement is important in the phenotypic analysis of cell division mutants because temporal changes of DNA volume can be used to monitor cycle progression and the fidelity of chromosome distribution. We have shown how the region growing parameter DkRG can be adjusted to minimize the error between a GT defined by human experts and the output of our automated segmentation method. Furthermore, live cell imaging is prone to low SNR as increased temporal resolution and the need to reduce illumination for the purpose of minimizing photobleaching and phototoxicity inevitably lowers photon yield. In addition, ‘‘biological noise’’ in the form of histone-GFP stored in cytoplasmic lipid droplets can affect the quality of nuclear segmentation. The adjustment of the parameter DkO helped to prevent a fusion of nuclear regions with cytoplasmic signals. Once optimized, it was possible to apply one parameter set from NC12 until gastrulation, which spans over 3 h of different developmental stages. A fixed parameter set is obviously helpful in quantifying cellular changes between frames. These parameters, however, were not perfect for NC11 and before when high levels of cytoplasmic histone-GFP in lipid droplets diminish the contrast between nuclei and cytoplasm. As such, in certain scenarios, it might be necessary to tune more than one parameter set. We have illustrated how the three level-set parameters Dk can be used to tune number and size of detected nuclei. The user manual (Supporting Information) outlines a heuristic strategy on how to optimize the parameter set. Ideally, a segmentation method should only require the input of parameters that can be easily measured and have a biological meaning like the size or shape of nuclei. Parameters that are too abstract such as level set parameters or those that vary between microscopes and experiments like fluorescence are less desirable. To make this method more intuitive, we envision two approaches. The first obvious approach would be to remove all user-defined parameters. A drawback of this strategy would be a loss of adaptability to different imaging scenarios involving other types of organisms, probes, or microscopes. We favor a second approach that would take advantage of the segmentation GT to automatically find a suitable combination of parameters. Given the rapidly falling cost of computer
11

Figure 5. The MLS segmentation method can be used to monitor cell cycle dependent changes of nuclear and chromosomal volume. A: Volume changes of a nucleus were tracked from interphase of NC11 in the syncytial blastoderm stage until onset of mitosis during gastrulation. B: Magnified views of mitosis in NC13 and (C) the first cell division in gastrulation show volume decreases due to chromosome condensation in prophase and chromosome separation in anaphase. Panel (B) also compares ground truth (blue) with machine segmentation (DkO 5 0.5, DkM 5 0.5, and DkRG 5 0.2). Because of the presence of brightly labeled histone-GFP droplets in NC11, we increased DkO from 0.5 to 1.5 for the first seven time points. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]

over, our method showed advantages in execution speed and handling larger image stacks. We like to stress, however, that benchmarking of segmentation algorithms should be taken with caution, as most approaches like ours are optimized for a particular application.
Cytometry Part A  00A: 00À00, 2011

ORIGINAL ARTICLE

Figure 6. Comparison of the MLS method (A and D) with the Otsu’s adaptive thresholding method (B and E) and the 3D segmentation method of the FARSIGHT Toolkit (C and F). Contours of individual optical sections were projected onto the raw images. Segmentation was performed on two image stacks of 1024 3 1024 3 68 voxels, one showing interphase nuclei during the early cellular blastoderm (A—C) and another one showing postcellular blastoderm cells in different phases of the cell cycle. D and F: Contours in image stacks containing postblastoderm cells indicate that nuclei correctly segmented by the MLS method (D, arrows) tend to appear fragmented in outputs of the FARSIGHT method (F). The scale bars in all panels represent 5 lm. [Color figure can be viewed in the online issue, which is available at wileyonlinelibrary.com.]

hardware, it appears feasible to run an optimization strategy, for example, genetic algorithm, on a computer cluster to search for an appropriate parameter set that works well on a representative collection of 3D images. In our experiments, we usually captured 3- to 4-h movies at 1-min intervals. To routinely segment large quantities of 3D stack, we took a variety of measures. The speed of level set evolution is enhanced with a fast NB approach, and productivity is further increased through batch and parallel processing. In summary, we have presented an automated segmentation method that is aimed at the characterization of cell division genes in early Drosophila embryogenesis. Our results suggest that this method can also be applied to other models
12

like zebrafish and to images acquired using other imaging modalities such as light sheet microscopy.

ACKNOWLEDGMENTS
´ The authors thank Wee Choo Puah and Mate Biro for microscopy and providing images of Drosophila embryos. They thank Tiehua Du for his help and discussions. They also thank the Biopolis Shared Facilities for help with confocal microscopy.

LITERATURE CITED
1. Malumbres M, Barbacid M. Cell cycle, CDKs and cancer: A changing paradigm. Nat Rev Cancer 2009;9:153–166.

3D Segmentation of Nuclei and Mitotic Chromosomes

ORIGINAL ARTICLE
2. Neumann B, Held M, Liebel U, Erfle H, Rogers P, Pepperkok R, Ellenberg J. Highthroughput RNAi screening by time-lapse imaging of live human cells. Nat Methods 2006;3:385–390. ´ ´ 3. Neumann B, Walter T, Heriche J-K, Bulkescher J, Erfle H, Conrad C, Rogers P, Poser I, Held M, Liebel U, et al. Phenotypic profiling of the human genome by time-lapse microscopy reveals cell division genes. Nature 2010;464:721–727. 4. Jaqaman K, King EM, Amaro AC, Winter JR, Dorn JF, Elliott HL, McHedlishvili N, McClelland SE, Porter IM, Posch M, et al. Kinetochore alignment within the metaphase plate is regulated by centromere stiffness and microtubule depolymerases. J Cell Biol 2010;188:665–679. 5. Garcia K, Duncan T, Su TT. Analysis of the cell division cycle in Drosophila. Methods 2007;41:198–205. 6. Minden JS, Agard DA, Sedat JW, Alberts BM. Direct cell lineage analysis in Drosophila melanogaster by time-lapse, three-dimensional optical microscopy of living embryos. J Cell Biol 1989;109:505–516. 7. Warn RM, Flegg L, Warn A. An investigation of microtubule organization and functions in living Drosophila embryos by injection of a fluorescently labeled antibody against tyrosinated alpha-tubulin. J. Cell Biol 1987;105:1721–1730. 8. Endow SA, Komma DJ. Centrosome and spindle function of the Drosophila Ncd microtubule motor visualized in live embryos using Ncd-GFP fusion proteins. J Cell Sci 1996;109 (Part 10):2429–2442. 9. Foe VE. Mitotic domains reveal early commitment of cells in Drosophila embryos. Development 1989;107:1–22. 10. Harder N, Eils R, Rohr K. Automated classification of mitotic phenotypes of human cells using fluorescent proteins. Methods Cell Biol 2008;85:539–554. 11. Meijering E, Dzyubachyk O, Smal I, van Cappellen WA. Tracking in cell and developmental biology. Semin Cell Dev Biol 2009;20:894–902. 12. Lin G, Adiga U, Olson K, Guzowski JF, Barnes CA, Roysam B. A hybrid 3D watershed algorithm incorporating gradient cues and object models for automatic segmentation of nuclei in confocal image stacks. Cytometry Part A 2003;56A:23–36. 13. Otsu N. A threshold selection method from gray-level histograms. IEEE Trans Syst Man Cybern 1979;9:62–66. 14. Chen Y, Ladi E, Herzmark P, Robey E, Roysam B. Automated 5-D analysis of cell migration and interaction in the thymic cortex from time-lapse sequences of 3-D multi-channel multi-photon images. J Immunol Methods 2009;340:65–80. 15. Bao Z, Murray JI, Boyle T, Ooi SL, Sandel MJ, Waterston RH. Automated cell lineage tracing in Caenorhabditis elegans. Proc Natl Acad Sci USA 2006;103:2707–2712. 16. Long F, Peng H, Liu X, Kim SK, Myers E. A 3D digital atlas of C. elegans and its application to single-cell analyses. Nat Methods 2009;6:667–672. 17. Lin G, Chawla MK, Olson K, Guzowski JF, Barnes CA, Roysam B. Hierarchical, model-based merging of multiple fragments for improved three-dimensional segmentation of nuclei. Cytometry Part A 2005;63A:20–33. 18. Kharma N. Automatic segmentation of cells from microscopic imagery using ellipse detection. IET Image Process 2007;1:39–47. 19. Li G, Liu T, Tarokh A, Nie J, Guo L, Mara A, Holley S, Wong ST. 3D cell nuclei segmentation based on gradient flow tracking. BMC Cell Biol 2007;8:40. 20. Al-Kofahi Y, Lassoued W, Lee W, Roysam B. Improved automatic detection and segmentation of cell nuclei in histopathology images. IEEE Trans Biomed Eng 2010;57:841–852. 21. Santella A, Du Z, Nowotschin S, Hadjantonakis A-K, Bao Z. A hybrid blob-slice model for accurate and efficient detection of fluorescence labeled nuclei in 3D. BMC Bioinformatics 2010;11:580. 22. Osher S, Sethian JA. Fronts propagating with curvature-dependent speed: Algorithms based on Hamilton-Jacobi formulations. J Comput Phys 1988;79:12–49. 23. Chan TF, Vese LA. Active contours without edges. IEEE Trans Image Process 2001;10:266–277. 24. Dufour A, Shinin V, Tajbakhsh S, Guillen-Aghion N, Olivo-Marin J-C, Zimmer C. Segmenting and tracking fluorescent cells in dynamic 3-D microscopy with coupled active surfaces. IEEE Trans Image Process 2005;14:1396–1410. 25. Rizzi B, Sarti A. Region-based PDEs for cells counting and segmentation in 3D1time images of vertebrate early embryogenesis. Int J Biomed Imaging 2009;2009:968–986. 26. Yau C, Wakefield J. Quantitative Image Analysis of Chromosome Dynamics in Early Drosophila Embryos. In: 2007 4th IEEE International Symposium on Biomedical Imaging: From Nano to Macro. Arlington, VA, USA; 2007. p 264–267. 27. Zhang B, Zimmer C, Olivo-Marin J. Tracking fluorescent cells with coupled geometric active contours. In: 2004 2nd IEEE International Symposium on Biomedical Imaging: Macro to Nano, Arlington, VA, USA. 2004. pp 476–479. 28. Dzyubachyk O, van Cappellen WA, Essers J, Niessen WJ, Meijering E. Advanced level-set-based cell tracking in time-lapse fluorescence microscopy. IEEE Trans Med Imaging 2010;29:852–867. 29. Shi Y, Karl WC. A real-time algorithm for the approximation of level-set-based curve evolution. IEEE Trans Image Process 2008;17:645–656. 30. Zhao T, Murphy RF. Automated learning of generative models for subcellular location: Building blocks for systems biology. Cytometry Part A 2007;71:978–990. 31. Clarkson M, Saint R. A His2AvDGFP fusion gene complements a lethal His2AvD mutant allele and provides an in vivo marker for Drosophila chromosome behavior. DNA Cell Biol 1999;18:457–462. 32. Dean P, Mascio L, Ow D, Sudar D, Mullikin J. Proposed standard for image cytometry data files. Cytometry 1990;11:561–569. 33. Adiga PSU, Chaudhuri BB. An efficient method based on watershed and rule-based merging for segmentation of 3-D histo-pathological images. Pattern Recognit 2001;34:1449–1458. 34. Jain A. Algorithms for Clustering Data. Englewood Cliffs, NJ: Prentice Hall; 1988. 35. Chopp D. Computing minimal surfaces via level set curvature flow. J Comput Phys 1993;106:77–91. 36. Shi Y. Partial differential equation based processing of images and video—A real-time algorithm for the approximation of level-set-based curve evolution. IEEE Trans Image Process 2008;17:645–656. 37. Wu HS, Barba J, Gil J. Iterative thresholding for segmentation of cells from noisy images. J Microsc 2000;197 (Part 3):296–304. 38. Lefohn A, Whitaker RT. A GPU-based, three-dimensional level set solver with curvature flow [Internet]. Utah: University of Utah; 2002. Available at:http://graphics. cs.ucdavis.edu/lefohn/work/rls/denseLevelSet/. Accessed on October 20, 2011. ~ 39. VTK [Internet]. Available at http://www.vtk.org/. Accessed on October 20, 2011. 40. Lin G, Chawla MK, Olson K, Barnes CA, Guzowski JF, Bjornsson C, Shain W, Roysam B. A multi-model approach to simultaneous segmentation and classification of heterogeneous populations of cell nuclei in 3D confocal microscope images. Cytometry Part A 2007;71A:724–736. 41. Open Computer Vision Library [Internet]. Available athttp://sourceforge.net/projects/opencvlibrary/files/. Accessed on October 20, 2011. 42. Cermelli S, Guo Y, Gross SP, Welte MA. The lipid-droplet proteome reveals that droplets are a protein-storage depot. Curr Biol 2006;16:1783–1795. 43. Belien JAM, van Ginkel HAHM, Tekola P, Ploeger LS, Poulin NM, Baak JPA, van Diest PJ. Confocal DNA cytometry: A contour-based segmentation algorithm for automated three-dimensional image segmentation. Cytometry 2002;49:12–21.

Cytometry Part A  00A: 00À00, 2011

13


Neighborhood Filtering in cryoEM
Alexandre Cunha† and Grant Jensen⋆
Division of Biology⋆ Center for Advanced Computing Research† California Institute of Technology 1200 E. California Boulevard, Pasadena CA 91125, USA cunha@caltech.edu, jensen@caltech.edu

ABSTRACT Electron cryomicroscopy, cryoEM for short, is an intrinsically noisy technique. To image a biological specimen using a beam of electrons we must carefully control radiation to avoid damaging the specimen. The electron dosage is predominantly low and as a consequence of this physical limitation the images formed by the CCD camera are poorly resolved. Noise is abundant in the two dimensional projections captured by the camera and in the case of tomography it is carried out to the three dimensional algorithmic reconstruction of the object being imaged. Noise characterization and reduction are then natural steps to improve the quality of the projections and enhance the ﬁdelity of 3D reconstructions. In this work we address noise reduction in cryoEM tomograms using neighborhood ﬁlters. In neighborhood ﬁltering the intensity value at a point p in the image is given by a weighted average value up that takes into account both spatial location and intensity similarity of neighboring points, i.e., ¯ up = q∈Np wpq uq , where wpq represents a weighting function between two points p and q in the image, and ¯ for q belonging to a neighborhood Np of point p. The weight wpq measures the spatial and intensity distances between points p and q and the closer they are the larger the weight and thus the stronger the inﬂuence of the point intensity in its neighbor. Filters of these type include, among others, the popular bilateral ﬁlter of Tomasi & Manduchi [3], which is a modiﬁed version of the less known neighborhood ﬁlter of Yaroslavsky [2], and the contemporary non–local mean ﬁlter of Buades, Coll & Morel [1]. Variational interpretations of these ﬁlters exist as well as theoretical and experimental comparisons providing valuable insights. But less is known about their application and eﬃcient implementation for ﬁltering large 3D image data sets and in particular in cryoEM. In this work we draw mainly on the work of Buades, Coll & Morel and report on experiments with their ﬁlter and extensions of our own in various images of Caulobacter crescentus cells (see Figure 1). Interesting is the connection between neighborhood ﬁltering and cryoEM single particle reconstruction methods, as they were originated in diﬀerent communities but share the same philosophy: both schemes aim to produce good images as a result of averaging clusters of similar patches. And they are both computationally demanding methods. Particle reconstruction requiring over 4,000 processing hours have been reported in the literature [4]. Non–local mean ﬁltering as reported by others and according to our experience is also remarkably slow. Nevertheless, these techniques have shown unsurpassed results in practice and deserve further developments. We are working to make both computationally more attractive to the structural biologist. REFERENCES [1] A. Buades, B. Coll, and J. M. Morel. A review of image denoising algorithms, with a new one. Multiscale Modeling Simulation, 4(2):490–530, 2005. [2] L. P. Yaroslavsky. Digital Picture Processing. Springer-Verlag New York, Inc. Secaucus, NJ, USA, 1985. [3] C. Tomasi and R. Manduchi. Bilateral ﬁltering for gray and color images. Proceedings of the Sixth International Conference on Computer Vision, pages 50–66, 1998. [4] Sjors H. W. Scheres, Haixiao Gao, Mikel Valle, Gabor T. Herman, Paul P. B. Eggermont, Joachim Frank, Jos´-Maria Carazo, Disentangling conformational states of macromolecules in 3D-EM through likelie hood optimization. Nature Methods, 4:27–29, 2007

Fig. 1. Two examples of non–local mean ﬁltering of electron cryotomograms of Caulobacter crescentus cells. The three ﬁgures above depict, respectively, a typical low contrast slice of a reconstructed tomogram (note its sharp histogram spanning 256 gray levels) followed by its normalized version (the one we process) and the ﬁltered result. Denoising is more noticeable in predominantly homogeneous neighborhoods as it is the case in regions outside the cell where vitreous ice is dominant. The ﬁlter performs equally well inside the cell preserving important structures as shown in the rectangular window where ﬁlamental structures have been signiﬁcantly accentuated thus facilitating their visualization and posterior automatic segmentation. In the ﬁgure below we have multiscale views of, from top to bottom, a normalized slice of another Caulobacter crescentus tomogram, followed by the noise pattern (scaled for visualization purposes) which was removed to obtain the denoised tomogram shown in the bottom pictures. Note in the rightmost column the good performance of the ﬁlter in averaging intensity values without destroying the structure. The picture is more revealing when zoomed in the computer screen; at higher magniﬁcation the reader will be able to notice the edge staircase eﬀect along the outer membrane of the cell which can be eliminated using a high order smoothing scheme or regression correction.


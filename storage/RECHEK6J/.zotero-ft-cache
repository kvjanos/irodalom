Pattern Recognition 35 (2002) 2319 – 2322

Rapid and Brief Communication

www.elsevier.com/locate/patcog

A ‘no-threshold’ histogram-based image segmentation method
N. Bonneta; b;∗ , J. Cutronaa; b , M. Herbinb
a INSERM-UMRS b LERI,

unit 514, Hˆ pital Maison Blanche, 45 Rue Cognacq Jay, F-51092 Reims Cedex, France o IUT, University of Reims, BP 1035, F-51687 Reims Cedex 2, France Received 13 February 2002; accepted 27 February 2002

Abstract Although most histogram-based image segmentation methods rely on the identiÿcation of a good threshold, we show that thresholding is not mandatory. Instead, we propose the association of grades of membership to each individual pixel, in order to perform probabilistic relaxation in the image space (which realizes some kind of regularization) and ÿnally to obtain the segmented image through defuzzyÿcation of the relaxed grades of membership. ? 2002 Pattern Recognition Society. Published by Elsevier Science Ltd. All rights reserved.
Keywords: Image segmentation; Fuzzy logic; Probabilistic relaxation; Probability density

1. Introduction Image segmentation is one of the oldest and most di cult problem in the ÿeld of image processing=analysis. Although gray-level thresholding is often too na ve to produce useful results, this approach is still the subject of many papers suggesting new methods in order to obtain the right gray-level threshold automatically. Some methods work in the crisp mode (the grades of membership are always 0 or 1 along the search procedure) while others work in the fuzzy mode (during the course of the search procedure, the grades of membership of pixels to the di erent classes are fuzzy and, at the end, a ÿnal defuzzyÿcation provides the required crisp grades of membership). On the other hand, di erent image segmentation procedures attempt to avoid explicit gray-level thresholding by performing pixel clustering directly, without the need to compute the gray-level histogram. Again, hard and fuzzy clustering techniques can be distinguished, with the K-means (KM) technique in the ÿrst group and the fuzzy C-means (FCM) technique in the second group, for instance. Neither histogram-based nor clustering-based

methods, at least in their simplest implementations, take into account the coordinates of the pixels and the concept of connectivity. Taking these concepts into account leads to other types of segmentation approaches, such as region growing, snakes, watersheds, which fall outside the scope of this note. Here, we advocate for a new method which: (a) performs image segmentation without the need to choose a threshold, (b) takes into account the fuzzy nature of a pixel (deÿned by its gray level) belonging to a class of pixels, (c) takes into account the probability density function of the di erent classes of pixels which compose an image, (d) takes into account the complete structure of a pixel, i.e. its geometrical coordinates in addition to its gray level, (e) can be generalized to take into account several attributes of a pixel (and not necessarily its gray level only) and to multi-component images. The rationale for the method comes from a new clustering method we have developed recently [1,2]. This method is based on the estimation of the global probability density function (in the parameter space describing the pixel features), its partitioning obtained using tools originating from mathematical morphology (skeleton by in uence zones

∗ Corresponding author. INSERM-UMRS unit 514, Hˆ pital o Maison Blanche, 45 Rue Cognacq Jay, F-51092 Reims, Cedex, France. Tel.: +33-3-26-78-77-71; fax: +33-3-26-06-58-61. E-mail address: noel.bonnet@univ-reims.fr (N. Bonnet).

0031-3203/02/$22.00 ? 2002 Pattern Recognition Society. Published by Elsevier Science Ltd. All rights reserved. PII: S 0 0 3 1 - 3 2 0 3 ( 0 2 ) 0 0 0 5 7 - 2

2320

N. Bonnet et al. / Pattern Recognition 35 (2002) 2319 – 2322

or watersheds) and the partitioning of the image space according to the labels obtained in the parameter space. This hard clustering technique was recently extended towards fuzzy clustering ([3]; Bonnet et al., in preparation). For the speciÿc case of image segmentation, the results of fuzzy segmentation (without defuzzyÿcation) can still be improved by probabilistic relaxation [4,5], which constitutes the next step of the procedure, before defuzzyÿcation. 2. Description of the procedure First, the histogram of the image is computed 1 with the aim of estimating the global 2 probability density function (pdf) of the di erent classes of pixels present in the image. For this, we have to regularize the histogram. This can be done using the classical Parzen–Rosenblatt method, with a Gaussian or other-shaped kernel. After regularization, we consider that each mode of the estimated pdf corresponds to one class of pixels. Hard partitioning of the one-dimensional histogram (i.e. the choice of a threshold) could be done according to one of the dozens of methods already suggested for this purpose. But these methods can hardly be generalized to two- or three-dimensional histograms. So, we prefer to consider other partitioning methods inherited from mathematical morphology (SKIZ or watersheds), as described in Refs. [1,2]. This partitioning of the parameter space, followed by the partitioning of the image space, already constitutes a ‘no threshold’ segmentation approach. But we propose to go one step further, i.e. performing image segmentation without even the need to search for the boundaries between classes in the parameter (gray level) space. For doing this, the only thing we need is to characterize each gray level gl (or, more generally, each sampling point in the parameter space), i.e. to specify its grades of membership to the di erent classes c of gray levels: (gl; c); gl = 1; : : : ; GL; c = 1; : : : ; C. Then, the results can be reported in the image space: I (x; y) = gl → x; y (c) = (gl; c). Now, instead of performing simple defuzzyÿcation, x; y (c) → label = arg maxc ( (gl; c)) one is better to try improving the results obtained without taking the coordinates of the pixels into account. This can be done through probabilistic relaxation, where the grades of membership are iteratively updated taking into account the grades of membership of other pixels in the neighborhood.
1 A ÿrst-order (one-dimensional) histogram is considered in this note, for simplicity. But the procedure can be extended easily to pixels described by several features, leading to two- or three-dimensional histograms. 2 Global means that, contrary to what happens with supervised procedures, the di erent classes here are mixed and their pdf cannot be estimated separately.

The very last point which remains to be described is: how can we get the grades of membership (gl; c) from the global estimated pdf ? Obviously, several possibilities can be imagined, which depend on the deÿnition of fuzziness we adopt. In this short note, we just want to illustrate the principle of the method through a simple approach. Basically, we want to take into account the statistics of the image, through the shape and height of the di erent modes of the pdf. 3 One possibility is to deÿne the following function: (gl; c) =
C c =1

exp(− [cost(gl; mc )]2 ) ; exp(− [cost(gl; mc )]2 )

where the cost of a path to a mode is related to the relative height amplitudes of the modes. As mentioned above, this deÿnition applies only to one-dimensional histograms, where the path from a point in the parameter space to the modes of the histogram is perfectly well deÿned. For multi-dimensional histograms, the deÿnition has to be more elaborated, using the concept of optimum (i.e. less costly) path [3].

3. Illustration The suggested procedure is illustrated in Fig. 1, through an example (muscle cells) with three classes. Figs. 1(a) – (c) display the original gray-level image, its gray-level histogram and the smoothed histogram, that can be considered as the estimation of the mixture of probability density functions for the three classes. Figs. 1(d) – (f) show the grades of membership obtained for each gray level, according to the method presented above. Figs. 1(g) – (i) display the same grades of membership in the image space, for class 0 (dark pixels), class 1 (medium gray levels) and class 2 (bright pixels), respectively. Fig. 1(j) displays the segmentation result (into three classes) obtained after probabilistic relaxation applied to the grades of membership and defuzzyÿcation. Fig. 1(k) shows, for comparison, the result obtained after hard thresholding of the original image into three classes, on the basis of the gray-level histogram (Fig. 1b). An unambiguous improvement can be noticed. But, more importantly, it should be stressed that the result obtained through hard thresholding is very sensitive to the choice of the thresholds. And it is well known that this choice, when made automatically, is strongly dependent on the criterion chosen for the automation. On the contrary, our method, which does not imply to select thresholds, is highly robust as a function of the di erent parameters used in the deÿnition of the grades of membership or the probabilistic relaxation approach.

3 Note that this philosophy is very similar to that of the Bayes theorem for supervised clustering.

N. Bonnet et al. / Pattern Recognition 35 (2002) 2319 – 2322

2321

Fig. 1. Illustration of the no-threshold segmentation procedure: (a) original image (muscle cells), (b) gray-level histogram, (c) smoothed gray-level histogram, (d) – (f) grades of memberships to the three classes, for each gray-level value, (g) – (i) grades of membership to the three classes, for each pixel, (j) result of segmentation into three classes, after probabilistic relaxation and defuzzyÿcation, (k) result of segmentation by hard thresholding.

2322

N. Bonnet et al. / Pattern Recognition 35 (2002) 2319 – 2322

4. Conclusion In this note, we have shown that na ve gray-level image thresholding can be strongly improved in the case of overlapping gray-level distributions and that trying to identify a good threshold is not mandatory. Improved segmented images can be obtained through a four-step procedure, which consists in: (a) estimating the pdf, (b) estimating the grades of membership in the parameter space, without threshold selection nor iterative method, (c) probabilistic relaxation performed on the grades of membership of pixels to the different classes, in the image space (d) defuzzyÿcation. The method has been described and illustrated here for single-component (scalar) images, single feature space (the gray level only) and a trimodal histogram. However, the method can be extended in di erent directions, without much e ort: (a) it can handle multi-modal histograms, (b) it can handle several features of a pixel, in a scalar image. It thus becomes an extension of the many approaches that attempt to incorporate local features, such as the gradient modulus, the average gray value in the neighborhood, texture features, etc. (c) it can handle vector images, such as color images, multi-spectral images and multi-modality images.

A more rigorous presentation of the method and of these extensions will constitute the subject of a forthcoming extended version of this short note. References
[1] M. Herbin, N. Bonnet, P. Vautrot, A clustering method based on the estimation of the probability density function and on the skeleton by in uence zones. Application to image processing, Pattern Recognition Lett. 17 (1996) 1141–1150. [2] N. Bonnet, Artiÿcial intelligence and pattern recognition techniques in microscope image processing and analysis, Adv. Imaging Electron Phys. 114 (2000) 1–77. [3] N. Bonnet, J. Cutrona, Improvement of unsupervised multi-component image segmentation through fuzzy relaxation, Proceedings of IASTED International Conference on Visualization, Imaging and Image Processing, Marbella, Spain, September 2001, pp. 477– 482. [4] A. Rosenfeld, R.A. Hummel, S.W. Zucker, Scene labeling by relaxation operations, IEEE Trans. Syst. Man Cybern. 6 (1976) 420–433. [5] J. Kittler, J. Illingworth, A review of relaxation labelling algorithms, Image Vision Comput. 3 (1985) 206–216.


BIOINFORMATICS APPLICATIONS NOTE
Systems biology

Vol. 26 no. 5 2010, pages 696–697 doi:10.1093/bioinformatics/btq013

Advance Access publication January 14, 2010

NEMO: a tool for analyzing gene and chromosome territory distributions from 3D-FISH experiments
E. Iannuccelli1,∗ , F. Mompart1 , J. Gellin1 , Y. Lahbib-Mansais1 , M. Yerle1 and T. Boudier2,3
1 Institut

National de la Recherche Agronomique, Laboratoire de Génétique Cellulaire, BP 52627, 31326 Castanet-Tolosan, 2 IFR83, Université Pierre et Marie Curie, 7 Quai Saint Bernard and 3 Université Pierre et Marie Curie, 4 Place Jussieu, 75005 Paris, France

Associate Editor: Alfonso Valencia

ABSTRACT Summary: Three-dimensional ﬂuorescence in situ hybridization (3D-FISH) is used to study the organization and the positioning of chromosomes or speciﬁc sequences such as genes or RNA in cell nuclei. Many different programs (commercial or free) allow image analysis for 3D-FISH experiments. One of the more efﬁcient open-source programs for automatically processing 3D-FISH microscopy images is Smart 3D-FISH, an ImageJ plug-in designed to automatically analyze distances between genes. One of the drawbacks of Smart 3D-FISH is that it has a rather basic user interface and produces its results in various text and image ﬁles thus making the data post-processing step time consuming. We developed a new Smart 3D-FISH graphical user interface, NEMO, which provides all information in the same place so that results can be checked and validated efﬁciently. NEMO gives users the ability to drive their experiments analysis in either automatic, semi-automatic or manual detection mode. We also tuned Smart 3D-FISH to better analyze chromosome territories. Availability: NEMO is a stand-alone Java application available for Windows and Linux platforms. The program is distributed under the creative commons licence and can be freely downloaded from https://www-lgc.toulouse.inra.fr/nemo Contact: eddie.iannuccelli@toulouse.inra.fr Received on September 22, 2009; revised on December 14, 2009; accepted on January 9, 2010

of the most efﬁcient programs for processing 3D-FISH confocal microscopy images is Smart 3D-FISH (Gue et al., 2005), an ImageJ [Rasband (1997–2009)] plug-in designed to automatically analyze distances between gene spots. This ImageJ plug-in provides a powerful automatic processing mode able to detect and measure object distances in multiple-channel experiments. After processing, Smart 3D-FISH uses predeﬁned parameters (for objects and images) to auto-estimate segmentation quality. Results are then manually checked using the various text and image ﬁles produced. The fact that data were spread across various text and image ﬁles made the post-processing step time consuming. We decided to develop new software, NEMO, a Smart 3D-FISH graphical user interface providing all data in one place to improve result investigation; NEMO gives users the ability to drive their experiments analysis either in automatic, semi-automatic or manual detection mode. Cells annotations and processing results are stored in the NEMO relational database (MySQL) helping users to better manage and extract data for post-processing analysis. We also tuned Smart 3D-FISH to better detect chromosome territories (CTs).

Downloaded from bioinformatics.oxfordjournals.org at UCL Library Services on April 11, 2011

2

PROGRAM FEATURES

Features can be divided according to the analysis process steps: ﬁelds images import, cells outlining, parameters setup, cells processing and results validation.

1

INTRODUCTION

2.1

Field image import

Now that genome sequencing has been mastered and cell imaging techniques have vastly improved our understanding of cell structure and function, there is an increasing demand in life science studies for cell imaging techniques and for ways to provide accurate localization of genes and their products within cells and tissues. Threedimensional ﬂuorescence in situ hybridization, 3D-FISH (Solovei et al., 2002), is used to study the organization and positioning of chromosomes, sub-chromosomal regions and/or speciﬁc sequences such as genes or RNA in cellular preparations with the 3D structure of the chromatin preserved by hybridization of probes with complementary sequences. Many different programs allow image analysis for 3D-FISH experiments (commercial or free) and one

The user creates a new ﬁeld by providing a name, a directory path, the number of channels (one to seven), their names and colours. The 8-bit or 16-bit gray level TIFF image stacks can be imported for each channel (additional image formats will be supported in future release). NEMO can process epiﬂuorescence (deconvolved or not) and confocal stacks knowing that results pertinence always depends on raw image quality

2.2

Cell outlines

∗ To

whom correspondence should be addressed.

A ﬁeld contains several cells; a user can deﬁne each cell by drawing a region of interest (ROI) onto the ﬁeld image. This ROI is used to produce a sub-image representing only that cell for further processing. NEMO also provides a function that detects cells in ﬁelds automatically by taking into account circularity and minimum area parameters for individual nuclei, based on automatic isodata thresholding on the whole nucleus projection image.

696

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

NEMO

2.3

Parameters setup for object detection

The parameters to be entered are of two types: processing parameters and segmentation quality estimation parameters. Processing parameters deﬁne ﬁlters to run on raw images (Median 3D, TopHat 3D, mathematical morphology 3D) and xyz resolutions. Segmentation quality estimation parameters are used after processing to highlight unreliable results: minimal image signal-to-noise ratio, maximum object number, minimum and maximum object volumes.

2.4

Cell processing

Cell processing is a two step workﬂow: objects are ﬁrst detected from cells and then various distances are measured between objects. Objects are detected by computing seeds as brightest maximum local pixels above a global threshold, and a local threshold is then computed to aggregate neighboring pixels to the seed. Depending on objects type, spots, CTs or nuclei, the global thresholds are computed differently. After processing, users can visually inspect image segmentation and distance values using the NEMO interface. The distances computed are euclidean distances taking into account the xy and z resolutions. NEMO can compute center to center distances, center to border or border to border distances between objects (spots, CTs or nuclei). Border distances are computed based on the detection of the border pixels of the objects after segmentation. Unlike Smart 3D-FISH, the user can mask image artifacts or adjust the segmentation threshold to improve object detection. Objects can be added by manually pointing a pixel to use as seed or by drawing it as a ROI directly on the image stack.

Downloaded from bioinformatics.oxfordjournals.org at UCL Library Services on April 11, 2011

Fig. 1. NEMO main window showing ﬁeld cells in left panel tree view, selected cell images in right panel and various distances at bottom.

2.5

Result validation

in text ﬁles whose content is visible in the ‘Processing Log’ tab at the bottom of the screen. The NEMO MySQL database can be queried using a dedicated interface; the user can query cells, objects or distance data using criteria (name, status, comments, etc.). NEMO can be used in command-line interface so ﬁelds can be processed automatically in batch mode.

After cell processing, the user chooses a validation status (OK, Unreliable or Rejected) and writes a comment for the cell. Results are composed of object characteristics (coordinates, volume, area, compacity, radial and Feret Distance) and various distances concerning pairs of objects (distances, angle and co-localization percentage). Results are stored in ﬁles at the time of validation. Users can use NEMO with or without a MySQL database, if the database is indicated in the preferences; in this case, results are also stored in the database.

4

CONCLUSION

3

USER INTERFACE

Reliable and fast measurements of the relative positioning of genes toward their chromosomal territories are essential to analyze the role of nuclear architecture on the regulation of gene expression in three dimensions. NEMO is a user-friendly interface to interactively analyze and visualize FISH 3D images. NEMO automatically detects objects in the images (spots, CTs or nuclei) nevertheless the user has the possibility to interact with the program to delete or add objects. The results are then stored in a relational database (MySQL) for further analyses. Conﬂict of Interest: none declared.

The NEMO interface is made up of a four-level hierarchical tree view representing ﬁeld cells and objects in different channels (Fig. 1). The user can explore the results by browsing this tree view. Various measurements (depending on the item currently selected in the tree view) are displayed at the bottom of the window. Cell images (raw and segmented) can be displayed by double-clicking the cell item in the tree view. When a cell is displayed, detected objects can be localized in the images by clicking on them in the tree view (objects are highlighted red in the segmented image view). A Y -axis projection view of raw images and an interactive 3D reconstruction view can be displayed in separate windows. User actions are logged

REFERENCES
Gue,M. et al. (2005) Smart 3D-FISH: automation of distance analysis in nuclei of interphase cells by image processing. Cytometry A, 67, 18–26. Rasband,W.S. (1997–2009) ImageJ, U.S. National Institutes of Health, Bethesda, MD, USA. Available at http://rsb.info.nih.gov/ij/. Solovei,I. et al. (2002) Spatial preservation of nuclear chromatin architecture during three-dimensional ﬂuorescence in situ hybridization (3D-FISH). Exp. Cell Res., 276, 10–23.

697


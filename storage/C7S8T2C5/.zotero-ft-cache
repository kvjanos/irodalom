COMPUTER VISION AND IMAGE UNDERSTANDING

Vol. 67, No. 3, September, pp. 261–273, 1997 ARTICLE NO. IV970536

Computing and Simplifying 2D and 3D Continuous Skeletons
Dominique Attali
Laboratoire TIMC-IMAG, Equipe INFODIS, Institut Albert Bonniot, Domaine de la Merci, 38706 La Tronche Cedex, France

and Annick Montanvert
L.I.P., E.N.S. de Lyon, 46 allee d’Italie, 69364 Lyon Cedex 07, France ´ Received March 21, 1995; accepted July 15, 1996

Skeletons provide a synthetic and thin representation of objects. Therefore, they are useful for shape description. Recent papers have proposed to approximate the skeleton of continuous shapes using the Voronoi graph of boundary points. An original formulation is presented here, using the notion of polyballs (we call polyball any ﬁnite union of balls). A preliminary work shows that their skeletons consist of simple components (line segments in 2D and polygons in 3D). An efﬁcient method for simplifying 3D continuous skeletons is also presented. The originality of our approach consists in simplifying the shape without modifying its topology and in including these modiﬁcations on the skeleton. Depending on the desired result, we propose two strategies which lead to either surfacical skeletons or wireframe skeletons. Two angular criteria are proposed that allow us to build a size-invariant hierarchy of simpliﬁed skeletons. © 1997 Academic Press

1. INTRODUCTION

The notion of skeleton was ﬁrst introduced by Blum [1]. The skeleton of an object is a thin ﬁgure centered in the shape which summarizes its general form. It consists of branches associated with the protrusions of the shape and loops associated with its holes. The skeleton provides a useful tool for shape description and is a well-known transformation of image analysis and shape recognition. Numerous methods have been proposed in order to extract the skeleton. They can be classiﬁed in three main families: • Exact methods. Finding the exact skeleton of an object is a complex problem. So far, this problem has been solved for very few objects. In [2], Lee has proved that the exact skeleton of a polygon was a subgraph of the generalized Voronoi graph of its boundary. • Discrete methods. The object is stored in a binary
261

image. The skeleton is redeﬁned in a discrete space. It is computed using tools of discrete geometry (homotopic thinnings, medial line extractions from distance maps) [3–8]. The result is a discrete skeleton, in other words, a set of 8-connected pixels in an image. Some 3D extensions have been proposed in the literature [9–13]. More recently, it has become of interest to study skeletonization of 2D grey-scale images in order to avoid the segmentation step [14, 15]. • Continuous methods. The object is deﬁned by a set of points that samples its boundary. Such data are often available. For instance, 3D surface points can easily be deduced from a collection of cross sections or by interactive acquisition using some 3D (optic, electromagnetic, radar) locator device. Recently, it has been proposed to use the Voronoi graph of the sample points in order to approximate the skeleton [16–19]. Indeed, the computational cost of the Voronoi graph of a reasonable set of points is no longer prohibitive [20–22]. Furthermore, by using directly the sample points, there is no need to perform any shape digitalization. The term ‘‘continuous methods’’ indicates that, unlike discrete methods, points with real coordinates are manipulated. This paper is concerned with the generation and simpliﬁcation of 3D objects using continuous methods. So far, little research has been done on 3D continuous skeletons [23, 24]. Yet, due to the fast development of medical data acquisition, the analysis of real 3D data has become even more important in image understanding than before. An original formulation of continuous methods is ﬁrst provided, based on the notion of the polyball. A polyball designates a ﬁnite union of balls. In this paper, we prove that the skeleton of a polyball can be constructed exactly and that continuous methods consist in approximating shapes with polyballs and the skeletons of shapes with
1077-3142/97 $25.00 Copyright © 1997 by Academic Press All rights of reproduction in any form reserved.

262

ATTALI AND MONTANVERT

X is a ﬁnite set of points located on the boundary of X. The sampling density of E is the number w: w
1

max d(x, E).
x X

The sampling E converges to the boundary of the shape as the sampling density becomes inﬁnite. Samplings of the boundary can be deduced from the segmentation of images; 3D locator devices also provide such data.
FIG. 1. The skeleton is the locus of the centers of its maximal balls.

the skeletons of polyballs. The complexity of continuous methods is related to the complexity of the Voronoi graph. A well-known drawback of skeletonization is not to be a continuous transformation. Thus, little noise on the boundary makes some useless barbs appear in the computed skeleton. In order to overcome this problem, we propose efﬁcient methods to simplify noisy 3D skeletons. Small modiﬁcations of our simpliﬁcation process provide either surfacical or wireframe skeletons. This paper is organized as follows. In Section 2, the notions of skeleton, sampling, and polygonal approximation are introduced. The deﬁnitions of the Voronoi graph, the Delaunay tessellation, and the Gabriel graph are recalled. Section 3 deals with the general problem of approximating the skeleton of a continuous shape. Two theoretical results are established. First, we ﬁnd an equivalence condition for 2D continuous methods. Second, the skeleton provided by continuous methods is related to the skeleton of a particular polyball. In Section 4, different strategies to simplify noisy skeletons are proposed.
2. NOTATIONS AND DEFINITIONS

Polygonal approximation. Rather than describing the boundary of a shape by a sampling of its boundary, it will be sometimes more convenient to consider polygonal approximation of the shape. A polygonal approximation P of an object X designates a region of the space delimited by simple polygons in 2D and simple polyhedra in 3D. The vertices of the polygons and polyhedra sample the boundary of the shape. In computer graphics and geometric modeling, shapes are often represented by polygonal approximation. Such representation can result from the segmentation of 3D data using, for instance, a deformable contour model or a marching cubes algorithm. With the advent of laser scanning systems and 3D reconstruction techniques, complex polygonal approximation are rapidly becoming commonplace. 2.2. Neighborhood Graphs In this section, the deﬁnition and main properties of the Voronoi graph, the Delaunay tesselation, and the Gabriel graph are brieﬂy recalled. Those graphs will turn out to be useful in the next section to compute and characterize the skeleton of an object. Voronoi Graph. Let E be a ﬁnite set of points in RN and p a point of E. The Voronoi region of the point p is deﬁned as the set of points of RN closer to p than to any other element of E. More formally, V(p) m RN, d(m, p) d(m, E) .

Afterward, RN designates the Euclidean N-dimensional space and d the Euclidean distance. For any set of points F RN, F denotes its boundary and F c its complement. Where needed, X will be used to denote a general continuous object, P a polygonal object, and E a ﬁnite set of points. 2.1. Shape Representations Skeleton. The skeleton SK(X) of an object X RN is the locus of the centers of the maximal balls included in X (Fig. 1). A ball B included in X is said to be maximal if there exists no other ball included in X and containing B. Algorithms for computing the skeleton depend on the object representation. Continuous approaches are characterized by having as input a description of the boundary of the shape. This description can be either a sampling of the boundary or a polygonal approximation of the shape, as described in the following paragraphs. Sampling. A sampling E of the boundary of a shape

The Voronoi regions are convex polygons in 2D and convex polyhedra in 3D. The Voronoi graph Vor(E) of E consists of the boundaries of the Voronoi regions of E (Fig. 2a),

FIG. 2. (a) Voronoi graph; (b) Delaunay triangulation; (c) Gabriel graph.

2D AND 3D CONTINUOUS SKELETONS

263

Vor(E)
p E

V(p).

• the intersection of the Voronoi graph with the shape X [17], • the dual of a polygonal approximation Pw [18]. These methods are enumerated in a logical order and not a chronological order. Indeed, the ﬁrst three methods are related by an inclusion relationship. These methods are described and compared in the following sections. They have been experimented in 2D as well as in 3D space. Our main contribution concerns two points: • An original formulation of the second method is proposed. In this formulation, the approximate skeleton is interpreted as the exact skeleton of a union of Delaunay balls. • A condition is established under which the second and fourth methods are equivalent in 2D space. Before describing the different methods, one has ﬁrst to enumerate which properties a ‘‘good’’ approximate skeleton should verify: 1. Convergence. As the sampling density tends to inﬁnity, the approximate skeleton should converge to the exact skeleton. 2. Homotopy. The approximate shape and the approximate skeleton should have the same class of homotopy. In 2D space, it means they should have the same number of connected components and for each component, the same number of holes. 3. Reversibility. It must be possible to recover the approximate shape using the approximate skeleton. 3.1. First Method (SK1): Using the Inner Voronoi Vertices Schmitt [29] has introduced a mathematical framework in which he has proved that, if X is an orientable manifold of smoothness C 3 at least, then the Voronoi vertices of Vor(Ew) tend to the skeleton of the shape and its complement. Due to this result, a natural way to approach the skeleton is to take the set of Voronoi vertices included in the shape (Figure 3e): Sk1(X, Ew)
v X, v vertex of Vor(Ew)

The Voronoi graph of n points can be computed in O(n log n nN/2) in an N-dimensional space [25]. A comprehensive treatment of the Voronoi graphs may be found in [26, 27, 25]. Delaunay Tessellation. The dual of the Voronoi graph is a tessellation of the convex hull of E named the Delaunay tessellation (Fig. 2b). It can easily be deduced from the computation of the Voronoi graph. It is made up of simplices whose circumscribed balls contain no other points of E. If one assumes that there is no degenerate cases (no four points of E are cocircular in 2D and no ﬁve points of E are cospherical in 3D), the simplices are triangles in 2D and tetrahedra in 3D. Afterwards, the Delaunay tessellation of an n-point set E is denoted Del(E). As the Voronoi graph, it can be computed in O(n log n nN/2) in an N-dimensional space. Gabriel Graph. The Gabriel graph is another famous graph from computational geometry [28]. The Gabriel graph GG(E) of a set of points E RN is the set of simplices ]p1 , p2 , . . . , pN[ such that the smallest ball passing through the N points p1 , p2 , . . . , pN contains no points of E in its interior (Fig. 2c). The Gabriel graph of E can be constructed by removing from the Delaunay tessellation of E each N-face not intersecting its dual Voronoi edge. Consequently, the Gabriel graph of n points can be computed in O(n log n nN/2) in an N-dimensional space.
3. SKELETON APPROXIMATION

Recently, algorithms using the Voronoi graph of points sampled along the shape boundary have become of interest to compute the skeleton. The goal of this section is to review and compare different ways to use the Voronoi graph of boundary points in order to approximate the skeleton. In the following discussion, X designates a continuous shape and Pw a polygonal approximation of X. The vertices Ew of Pw sample the boundary of X with the sampling density w. The considered space is either 2D or 3D. The existing methods are all based on the same general scheme. First, the Voronoi graph Vor(Ew) is computed. Secondly, a subgraph is extracted from this Voronoi graph in order to approximate the skeleton of X. Differences between methods appear when choosing which subgraph should best approximate the skeleton. One can deﬁne the approximate skeleton as (Fig. 3): • the Voronoi vertices included in X [29], • the Voronoi elements included in X [30, 31],

v.

Indeed,
w

lim Sk1(X, Ew)

Sk(X).

Theoretically speaking, this work shows the relationship between Voronoi graphs and skeletons in a space of any dimension. But, in practice, the skeleton Sk1 is of poor help in order to describe shapes as it is a set of disconnected

264

ATTALI AND MONTANVERT

FIG. 3. Skeleton approximation: (a) continuous shape; (b) sampling of the boundary and corresponding Voronoi graph; (c) inner Delaunay triangles. One can deﬁne the approximate skeleton as: (e) the Vornonoi vertices included in the shape; (f) the Voronoi elements included in the shape; (g) the intersection of the Voronoi graph with the shape; (h) the dual of the inner Delaunay triangles. The skeleton deﬁned in (f) is the exact skeleton of the union of balls represented in (d).

points. Consequently, it contains no information on the topology of X. In order to overcome this problem, a possible idea is to add to Sk1 some elements that connect the inner Voronoi vertices, as described in the second method. 3.2. Second Method (Sk2): Using the Inner Voronoi Elements In this method [16], the skeleton is deﬁned as the Voronoi elements that are completely included in the shape (Fig. 3f), Sk2(X, Ew)
F X, F element of Vor(Ew)

Interpretation. The skeleton computed by this method has a very interesting property that helps to understand why inner Voronoi vertices should be connected by inner Voronoi elements. Indeed, it can be interpreted as the exact skeleton of a ﬁnite union of balls Yw . This union of balls is an approximation of the continuous shape X, constructed from the sample points Ew . Let a Delaunay ball be a ball circumscribed about a Delaunay simplex. Yw is made up of the Delaunay balls of Ew whose centers belong to X (Fig. 3d). We have Sk2(X, Ew) Sk(Yw).

F.

A Voronoi element can be a point or a straightline segment in 2D and a point, a straightline segment, or a polygon in 3D. It ensues that the approximate skeleton is a thin shape of the considered space. A convergence theorem has been established by Brandt for r-nice shapes. An r-nice shape is morphologically open and closed with respect to a disk of radius r and has at most a locally ﬁnite number of curvature inﬂections. For these shapes Brandt has proved in 2D that
w

lim Sk2(X, Ew)

Sk(X).

The convergence theorem is illustrated in Fig. 5.

This result derives from the general form of the skeleton of a ﬁnite union of balls. In Appendix A, it is proved that the skeleton of any union of balls can be constructed exactly. It is made up of line segments in 2D and polygons in 3D. Generally speaking, spherical representations have often been studied because they provide simple representations for graphical display and object modeling. In particular, they are well adapted to represent molecular surfaces [32]. In [33], spheres are used to deﬁne the isosurfaces of deformable objects. In [34], a collection of overlapping spheres is computed in order to make easier graphical representations. The possibility of computing efﬁciently the volume and other parameters of union of balls is studied in [35]. This paper provides another reason to use

2D AND 3D CONTINUOUS SKELETONS

265

the boundary of X which have no signiﬁcance in the computation of the skeleton. 3.4. Fourth Method (Sk0): Using the Dual of the Shape The method described in this section works on a polygonal approximation Pw of the shape. Boissonnat [18] was the ﬁrst to notice that if the condition Pw Del(Ew) is veriﬁed in 2D then, one could distinguish two types of Delaunay triangles, inner triangles lying inside Pw and partitioning Pw and outer triangles lying outside Pw and partitioning its complement (Fig. 3c). A 3D extension of this remark is straightforward. In 3D, if Pw Del(Ew), then there exist only two types of Delaunay tetrahedra: inner tetrahedra lying inside Pw and partitioning Pw and outer tetrahedra lying outside Pw and partitioning its complement. In other words, a Delaunay element (straightline segment, triangle, or tetrahedron) cannot intersect the boundary. One way to approach the skeleton is to consider the dual of the shape (Fig. 3h): Sk0(Pw) Dual(Pw).

FIG. 4. Inﬂuence of the sample points on the skeleton computation: (a) union of balls computed from different sampling of the boundary; (b) corresponding skeletons.

spherical representations: the skeleton of a ﬁnite union of balls can be exactly constructed. Sampling Inﬂuence. The skeletonization method described in this section consists in ﬁrst approximating the shape X with a union of balls Yw and then in approximating the skeleton of X with the exact skeleton of Yw . For a given sampling density, different samplings of the boundary provide different unions of balls (Fig. 4a). However, the computed skeleton remains stable (Fig. 4b). The initial location of the sample points on the boundary is of little importance for the method. Rather than using the exact skeleton of an approximating union of balls Yw , one may ask why not use directly the exact skeleton of the polygonal approximation Pw . Indeed, it can also be constructed exactly with straightline segments and pieces of parabola. Such an approach has several drawbacks. To each convex vertex of the polygon is associated a branch on the skeleton. Consequently, the method is very sensitive to the location of the sample points on the boundary and does not converge when the sampling density tends to inﬁnity. 3.3. Third Method (Sk3): Intersection of the Voronoi Graph with the Shape Ogniewicz [17] deﬁnes the discrete Voronoi medial axis as the intersection of the Voronoi graph with the shape (Fig. 3g), Sk3(X, Ew) X Vor(Ew).

Description. The dual of the shape is an adjacency graph of the inner simplices. In 2D, the dual is made up of Voronoi vertices connected by straightline segments if their associated simplices are adjacent. In 3D, the dual is made up of Voronoi vertices, straightline segments, and polygons. Straightline segments connect Voronoi vertices whose associated Delaunay tetrahedra are adjacent. Polygons are associated with inner tetrahedra that share a common inner Delaunay edge. Duality. The main advantage of this approach is that, by deﬁnition, the shape and the skeleton are dual. This duality is extremely attractive as each operation on the shape has an interpretation on the skeleton and vice versa. Due to this duality, it is also possible to prove that the shape and the skeleton are always homotopic. Furthermore, assuming that for each vertex of the approximate skeleton, the dual inner simplex has been memorized, the reversibility with Pw is ensured. The original shape is reconstructed by taking the union of inner simplices. Thus, the shape is described by an exact and nonredundant decomposition into triangles in 2D and tetrahedra in 3D. Existence. A drawback is that the deﬁnition of the approximate skeleton Sk0 has a meaning as long as the boundary of Pw is included in the Delaunay tessellation Del(Ew). Boissonnat refers to this condition as the contour containment condition. One might might this is a restrictive condition. But, Brandt and Algazi have proved in [16] that if the shape X to skeletonize is r-regular and if the sampling density w veriﬁes w 1 2r, then it is possible to sort the sample points Ew and to construct a polygonal approximation Pw that veriﬁes the contour containment condition.

Sk3 is an overset of Sk2 . The only difference is that some peripherical straightline segments are artiﬁcially added to Sk2 . These segments are terminated by points located on

266 3.5. Comparison of the Different Methods

ATTALI AND MONTANVERT

In this section, we compare the behavior of the four methods previously described. The ﬁrst three methods Sk1 , Sk2 , and Sk3 are related by the following inclusions: Sk1(X, Ew) Sk2(X, Ew) Sk3(X, Ew).

of X and let E be the set of vertices of P. If P is included in the Gabriel graph of E, then Sk2(P, E) Sk2(P , E)
c

Sk0(P) Sk0(P c).

Two methods are particularly relevant: Sk2 and Sk0 . Indeed, Sk2 ensures convergence toward the exact skeleton and Sk0 preserves homotopy and reversibility. Afterward, we shall limit ourselves to the comparison of Sk2 and Sk0 . If Sk0 and Sk2 were equivalent, it would be possible to have simultaneous convergence, homotopy preservation, and reversibility. But, these two methods are not equivalent in all cases. Unlike Sk2 , the approximate skeleton Sk0 may not be deﬁned if the contour containment condition is not veriﬁed. Furthermore, when the sampling points are sparsely located on the boundary, Sk0 may go outside the shape. This cannot happen with the approximate skeleton Sk2 that is forced to stay inside the shape by deﬁnition. On the other hand, Sk2 and the shape may not have the same class of homotopy. The difference between the two methods comes from the fact that an inner Delaunay triangle may be associated with an outer Voronoi vertex as illustrated in Fig. 3h and, conversely, an outer Delaunay triangle may be associated with an inner Voronoi vertex. We have established that the two methods are equivalent in 2D providing that the boundary of the polygonal approximation Pw is included in the Gabriel graph of the sample points Ew ( Pw GG(Ew)). This condition is particularly attractive as it does not depend on the sampling density, which is generally not known. The equivalence between the two methods has been established by ﬁrst seeking under which condition the skeleton Sk0 is forced to stay inside the shape. THEOREM 1. Let P R2 be a polygonal object and let E be the vertices of P. If P is included in the Gabriel graph of E then P Sk0(P) Sk0(P c) Del(P) P P c.

Therefore, the two methods Sk0 and Sk2 are equivalent in 2D as soon as the boundary of the polygonal approximation Pw is included in the Gabriel graph of the sample points Ew . Examples of polygonal approximation verifying this condition are provided in Figs. 4 and 5. We have not been able to extend the previous theorems to 3D space. Experimentally, the two methods do not lead to the same result, even for a high sampling density. A few peripherical branches remain different. In the following section, the skeleton Sk0 is preferred to Sk2 . 3.6. Complexity The computational time of the skeleton comes down to the computational time of the Veronoi graph. Consequently, it is in the worst case O(n log n) in 2D and O(n2) in 3D, where n is the number of sample points. The complexity of the representation (number of vertices of the skeleton) is O(n) is 2D and O(n2) in 3D. Nevertheless, we have noticed experimentally in 3D that the number of Voronoi vertices of the skeleton does not exceed 8n.
4. SIMPLIFYING 3D SKELETONS

Thus, when the boundary of the polygonal approximation Pw is included in the Gabriel graph GG(Ew), the contour containment condition is veriﬁed and the skeletons Sk0(Pw) and Sk0(P c ) do not intersect the boundary. One w can immediately deduce the following theorem. THEOREM 2. Let P R2 be a polygonal approximation

A drawback of the skeleton transformation is its lack of continuity. Noise on the boundary of an object may signiﬁcantly change the aspect of its skeleton (Figs. 5e and 5f). A simpliﬁcation algorithm is therefore necessary to remove peripherical branches having no perceptual relevance. In 2D space, numerous methods, more or less sophisticated, have been proposed in order to simplify discrete or continuous skeletons. Simpliﬁcation methods are generally based on the same scheme: peripherical branches are shortened by removing end points one after the other while they verify a removing criterion. By construction, the simpliﬁed skeleton is a subset of the initial skeleton having the same class of homotopy. Different removing criteria have been proposed. One can, for instance, measure the difference between the initial shape and the shape reconstructed from the simpliﬁed skeleton [4, 36, 16, 37]. Branches are shortened as long as this difference remains smaller than a ﬁxed threshold. This difference can be estimated by computing the Hausdorff distance or the lost area between the initial shape and the shape reconstructed from the simpliﬁed skeleton. More complex criteria may be found in [38].

2D AND 3D CONTINUOUS SKELETONS

267

FIG. 5. Illustration of the convergence theorem and sensibility to noise: (a) a ‘‘regular’’ continuous shape. From (b) to (e), the skeleton is computed with 10, 50, 100, and 200 sampling points. (f) Noise on the sample points disturbs the skeleton.

This section is concerned with the simpliﬁcation of 3D skeletons. So far, very few methods have been proposed in order to simplify 3D skeletons. Some extensions of discrete approaches may be found in [9–12]. In [24], a 3D simpliﬁed skeleton is used to describe the brain structure. But in this case, the proposed simpliﬁcation process is not convincing as it only removes a small part of the skeleton vertices. A drawback of existing simpliﬁcation methods is that they depend on thresholds that are difﬁcult to ﬁnd automatically as they change with the objects. In this section, the proposed removing criteria are size-invariant. The relevance of a branch is measured with an angle. The greater the angle, the more important the branch. 4.1. Methodology In this section, the approximate skeleton is assumed to be the dual of a polygonal approximation of the shape. Our simpliﬁcation process takes advantage of this duality between the approximate shape Pw and the approximate skeleton Sk0(Pw). It consists in simplifying Pw without modifying its topology and in including those modiﬁcations in the skeleton by duality. Thus, during the simpliﬁcation process, a simplex T is removed from the current shape if the two following properties are veriﬁed: 1. the homotopy class of the shape is not modiﬁed when T is removed, 2. T is not revelant according to a certain criterion. Different removing criteria are discussed in Section 4.3.

By duality, when the simplex T is removed from the current shape, its associated Voronoi vertex v and all the Voronoi elements passing through v are also removed from the skeleton. 4.2. Preserving Homotopy This section enumerates the simplices (triangles in 2D and tetrahedra in 3D) whose deletion does not alter the homotopy of the current shape (Fig. 6). In the following, an inner (resp. boundary) face or edge designates a face or an edge encluded in (resp. on the boundary of) the current union of tetrahedra. In 2D, only one type of triangles can be removed. They are associated with extremities of the skeleton and have one inner edge and two boundary edges. They are called hat triangles. In 3D, two types of inner tetrahedra can be removed: • Hat tetrahedra. They are characterized by three boundary faces and one inner face. The consequence of their deletion is to shorten a branch of the skeleton. The vertex v associated with a hat tetrahedron is called an extremity of the skeleton. • Salient tetrahedra. They are characterized by two boundary faces, two inner faces, and one inner edge (Fig. 6). The deletion of the salient tetrahedron T leads to the removal of its associated Voronoi vertex v and of the Voronoi polygon passing through v. The vertex v is called a border of the skeleton. Thus, during the 3D simpliﬁcation process, two elemen-

268

ATTALI AND MONTANVERT

Surfacical Skeletons. The ﬁrst criterion attempts to remove Voronoi polygons forming spines created by small boundary disturbances. In order to measure the relevance of a border v of the skeleton, we consider the salient tetrahedron T associated with v. T shares two faces in common with the current object boundary. Let (v) denote the angle between these two faces. The border v is removed in the angle (v) is less than a given threshold 0 . For instance, one can choose 0 /3. This criterion is easy to implement and gives good results when noise on the boundary remains small (Fig. 8). Wireframe Skeletons. A more sophisticated criterion is used to get wireframe skeletons. It is inspired by the method proposed by Ogniewicz [17] for 2D shapes. Before describing our criterion in 3D, its principle is brieﬂy explained in 2D space. By duality, the shape and the skeleton are simpliﬁed simultaneously. Thus, the removal of a skeleton branch implies the removal of an area of the object made up of Delaunay triangles. Afterwards, A(v) denotes the set of Delaunay triangles one has to remove from the initial object in order to remove the Voronoi vertex v (see Fig. 9). The size of A(v) gives an indication on the location of the vertex v within the skeleton. The more important A(v), the more interval v is within the skeleton. An estimation of the location of v can be provided by comparing the
FIG. 6. Simplices classiﬁcation. Only hat triangles, hat tetrahedra, and salient tetrahedra can be removed without altering the homotopy of the current shape.

tary transformations may affect the current shape: the removal of a hat tetrahedron and the removal of a salient tetrahedron. The associated transformation on the skeleton are the removal of an extremity and the removal of a border (Fig. 7). Consequently, two different strategies can be considered to simplify 3D skeletons, which lead to either surfacical skeletons or wireframe skeletons: • In order to get a surfacical skeleton, one has to preserve signiﬁcant borders and remove possible branches. To this end, hat tetrahedra must systematically be removed as they imply unidimensional parts in the skeleton. On the other hand, salient tetrahedra are removed if they verify a removing criterion. • To get wireframe skeletons, another strategy must be chosen which preserves signiﬁcant branches and remove possible borders. In this case, the systematic removal of salient tetrahedra is necessary. On the contrary, some hat tetrahedra must be preserved. 4.3. Removing Criteria In this section, we describe two removing criteria that enable us to compute respectively surfacical and wireframe skeletons. The proposed criteria are size-invariant.
FIG. 7. Consequence of the removal of a hat triangle, a hat tetrahedron, and a salient tetrahedron on the skeleton.

2D AND 3D CONTINUOUS SKELETONS

269

FIG. 8. The shape is sampled by 1308 points. Simpliﬁed skeletons of order (a) 0 0, (b) 0 /2, (c) 0 , (d) 0 2 , (e) pilling of the simpliﬁed skeletons, (f) pilling of the simpliﬁed polygonal shapes.

perimeter p(v) of A(v) with the radius r(v) of the Delaunay disk centered on v. When the area A(v) remains small, the quantity p(v)/r(v) provides an approximation of the solid angle under which v sees A(v). The vertex v is removed if the quantity p(v)/r(v) is less than a given threshgives excellent results. old 0 . The value 0 When one tries to extend the previous criterion to 3D space, the problem of how to extend the deﬁnition of A(v) comes. In order to overcome this problem, we propose to compute a 3D equivalent of the quantity p(v) without deﬁning explicitly the set A(v). This computation is realized in two steps: 1. Before the simpliﬁcation, the value p(v) of any vertex v of the skeleton is ﬁrst initialized as follows: if the Delaunay tetrahedron associated to v shares k faces f1 , . . . , fk with the boundary of the object, the value p(v) is set to p(v) area( f1) area( fk).

FIG. 10. (a) Polyhedral approximations. (b) Sampling points. (c) Approximate skeletons. (d) Surfacical simpliﬁed skeletons for 0 /3. (e) Wireframe simpliﬁed skeletons for 0 2 .

2. During the simpliﬁcation, if the vertex v is removed from the skeleton, the value p(vi) of each neighbor vi of v still belonging to the skeleton is modiﬁed as p(vi) p(vi) p(v) . k

FIG. 9. The set of grey triangles must be removed from the initial object before one can remove the Voronoi vertex v.

At each step of the simpliﬁcation, the total area computed on the vertices of the current skeleton remains constant. A vertex v of the skeleton is removed if the quantity p(v)/r(v) is less than a given threshold 0 , for instance 2 . Figure 10 illustrate some results of our simpliﬁcation methods. The ﬁrst shape is deﬁned by 1191 sampling points, the chromosome by 2290 points, and the vertebra by 2011 points. The computation for each object takes less than

270

ATTALI AND MONTANVERT

30 s on an INDIGO RS4000 Silicon Graphics workstation. The wireframe skeleton is remarkably representative. The number of automatically detected branches is 4 for the ﬁrst shape, 4 for the chromosome, and 13 for the vertebra.
5. CONCLUSION

Objects called polyballs have been studied. Their skeletons were proved to have simple components, which allows their exact computation either in 2D or 3D space. For this reason, polyballs are very interesting objects to represent continuous shapes. A complete review of continuous methods was presented in Section 4 and an original method using polyballs was described. We also compared continuous methods and proved their equivalence in 2D when the boundary of the polygonal approximation was included in the Gabriel graph of the sample points. We have also proposed an efﬁcient method for symplifying 3D noisy skeletons. The process is parametrized by an angel and thus is size-invariant. Depending on the chosen strategy, borders of the skeleton surface can be preserved, or, on the contrary, removed so that an almost wireframe ﬁgure is obtained. On the basis of our results, 3D skeletons are very promising for 3D objects analysis as, for example, the computation of distance between selected sites in a chromosome. The use of 3D skeletons for shape matching will be the subject of further research.
APPENDIX A: POLYBALLS

FIG. 11. 2D polyballs and their associated skeletons. Examples of maximal balls.

Among the generating balls, it will be useful to distinguish those having particular intersections with the others (see Fig. 11 and Fig. 12). DEFINITION 2. A generating ball Bi is said to be disconnected if it intersects no other generating ball. DEFINITION 3. The generating balls Bi and Bj are said to be quasi-disconnected if their intersection Bi Bj intersects no other generating ball. In the N-dimensional space, the boundary of Y has particular points, in ﬁnite number, located at the intersection of at least N generating balls. These points, referred to as singular points, are characterized as follows. DEFINITION 4. The point p is said to be a singular point of Y RN if and only if there exists at least N generating balls Bi1 , . . . , BiN such that p Y Bi1 Bi N . A.2. Skeletons of Polyballs We state two theorems describing 2D and 3D skeletons of polyballs. We prove that the skeleton of a polyball is

Computing the exact skeleton of a continuous shape is a difﬁcult problem. The solution is known only for some simple geometrical shapes such as ellipses, parabolas, cylinders. In 2D, much research effort has been expended on computing the exact skeleton of polygons. The skeleton of a polygon is made up of straightline segments and portions of parabolic curves [2]. It can be computed in O(n log n), where n designates the number of vertices on the boundary [2, 39]. In 3D, the skeleton of a polyhedron consists of pieces of quadrics [40, 41]. Its construction is much more difﬁcult. In this section, the problem of ﬁnding the exact skeleton is solved for a particular subset of continuous shapes called polyballs. A.1. Structure of Polyballs To simplify the following discussion, we call polyball any ﬁnite union of balls. A polyball may have a very general shape, formed of several connected components. In order to describe the skeleton of a polyball, we ﬁrst introduce some deﬁnitions. RN be a polyball. The writing DEFINITION 1. Let Y y i 1,...,k Bi is minimal if Y cannot be written with less than k balls. The balls Bi are said to be generating balls.

FIG. 12. 3D polyballs and their associated skeletons.

2D AND 3D CONTINUOUS SKELETONS

271

made up of simple components such as line segments in 2D and polygons in 3D. In particular, it passes throught the center of generating balls. Simple examples of polyballs and skeletons are provided Figs. 11 and 12. Afterward, generating balls are assumed not to be tangent. THEOREM 3. Let Y R2 be a polyball. The skeleton of Y is made up of the centers of the disconnected balls and a subset of the Voronoi graph of its singular points. This subject is formed of the points m Y such that the closest points to m on the boundary Y are singular points. Proof. Let m be a point of the skeleton and let B be the maximal ball with center m. As B is a maximal ball, B has at least two contact points with the boundary of Y. Suppose ﬁrst that all its contact points are singular points. B is a ball passing through at least two singular points and containing none. It results that m lies on the Voronoi graph of the singular points. Note that if B touches exactly two singular points, m lies on a Voronoi edge (Fig. 11a). If not, m is a Voronoi vertex (Fig. 11b). Suppose now that one of the contact points is not a singular point and belongs to the generating ball B0 . This implies that B is also a maximal ball of B0 and therefore B B0 . If B0 is not disconnected, B0 passes through at least two singular points and therefore m lies on the Voronoi graph of the singular points (Fig. 11c). If not, m is the center of a disconnected ball (Fig. 11d). Conversely, the center of any disconnected generating ball is a point of the skeleton. Let m Y be a point of the Voronoi graph of the singular points for which exists a singular point p verifying d(m, Y) d(m, p). The ball with center m and passing through p is a maximal ball, which completes the proof. THEOREM 4. In 3D, the skeleton of Y is made up of the centers of the disconnected balls, the straightline segments connecting the centers of the quasi-disconnected balls, and a subset of the Voronoi graph of its singular points. This subset is formed of the points m Y such that the closest points to m on the boundary Y are singular points. Proof. Let m be a point of the skeleton and B the maximal ball with center m. As B is a maximal ball, B has at least two contact points with Y. Suppose that all its contact points are singular points. As in the 2D case, m lies on the Voronoi graph of the singular points. Note that if B touches exactly two singular points, m describes a Voronoi polygon. If B touches exactly three singular points, m describes a Voronoi edge. In the other cases, m is a Voronoi vertex. Suppose now that one of the contact points is located at the intersection of exactly two quasi-disconnected balls B0 and B1 . Then, B touches the intersection circle of B0 and B1 . Therefore, m describes the line segment connecting the centers of B0 and B1 .

FIG. 13. Illustration for the proof of Theorem 1.

Finally, suppose that one of the contact points lies on the boundary of a generating ball, B0 . As in the 2D case, one can infer that m is the center of the generating ball B0 . Thus, m, as the center of B0 , may be the center of a disconnected ball, a quasi-disconnected ball, or it may lie on the Voronoi graph of the singular points. The converse is proved the same way as in 2D. To conclude, the skeleton of a polyball has a very simple structure. Its computation comes down to the computation of a Voronoi graph which is a very famous problem of computational geometry and for which efﬁcient algorithms exist.
APPENDIX B: PROOF OF THEOREM 1

In this section, Theorem 1 is demonstrated. As GG(E) Del(E), it follows that P Del(E). To verify the two other relationships, we ﬁrst demonstrate that to each inner Delaunay triangle is always associated one inner Voronoi vertex and, conversely, the outer Delaunay triangle is always associated to one outer Voronoi vertex. Let (abc) be a Delaunay triangle and v is associated Voronoi vertex (see Fig. 13a). It is assumed that v (abc) and that the points a and v are both sides of the line (bc). Let m be any point of the line segment ]va[ and [e0e1] be a Delaunay edge passing through m. As (abc) is a Delaunay triangle, the disk passing through a, b, and c contains no points of E and, consequently, does not contain e0 and e1 . Furthermore, as the Delaunay graph is a planar graph, it can be stated that ei a, for i 0, 1 . Thus, d(m, a) d(m, ei) and a is contained by the disk having e0e1 as diameter. Therefore, [e0e1] is not a Gabriel graph’s edge of the set E and neither is a boundary edge of the polygonal object P. To summarize, a path was found joining the Voronoi vertex v to the Delaunay triangle (abc) such that none of its points lies on the boundary of P. Consequently, the Delaunay triangle (abc) and the Voronoi vertex v are simultaneously, either included in P or included in its complement P c. To conclude, it must be demonstrated that a Voronoi

272

ATTALI AND MONTANVERT 16. J. W. Brandt and V. R. Algazi, Continuous skeleton computation by Voronoi diagram, CVGIP: Image Understanding 55(3), 1992, 329–337. 17. R. Ogniewicz and M. Ilg, Voronoi skeletons: Theory and applications, In Proc. IEEE Conf. on Computer Vision and Pattern Recognition, Champaign, Illinois, June 1992, pp. 63–69. 18. J. D. Boissonnat and B. Geiger, Three Dimensional Reconstruction of Complex Shapes Based on the Delaunay Triangulation, Technical Report No. 1697, INRIA, May 1992. 19. D. Attali and A. Montanvert, Semicontinuous skeletons of 2D and 3D shapes, in Aspects of Visual Form Processing (C. Arcelli et al., Eds.), pp. 32–41, World Scientiﬁc, Singapore. 20. K. Sugihara and M. Iri, Construction of the Voronoi diagram for one million generators in single-precision arithmetic, in First Canadian ´ Conference on Computational Geometry, Montreal, August 1989, pp. 1–31. 21. D. A. Field, Implementing Watson’s algorithm in three dimensions, in 2nd ACM Symposium in Computational Geometry, 1986, pp. 246–256. 22. E. Bertin and J.-M. Chassery, 3D Voronoi diagram: Application to segmentation, in 11th International Conference on Pattern Recognition, The Netherlands, 1992, pp. 197–200. 23. J. W. Brandt. Describing a solid with the three-dimensional skeleton. In Proc. SPIE Conf. Curves and Surfaces in Comp. Vision and Graphics III, 1992, Vol. 1830, pp. 258–269. ´ 24. G. Szekely, C. Brechbuhler, O. Kubler, R. Ogniewicz, and T. Budinger. Mapping the human cerebral cortex using 3D medial manifolds. In VBC’92, SPIE, 1992, Vol. 1808, pp. 130–143. ´ ´ 25. J.-D. Boissonnat and M. Yvinec. Geometrie Algorithmique. Ediscience international, 1995. 26. F. P. Preparata and M. I. Shamos, Computational Geometry: An Introduction. Springer-Verlag, New York/Berlin, 1988. 27. F. Aurenhammer, Voronoi diagrams—A survey of a fundamental geometric data structure, ACM Computing Surveys, 33(3), 1991, 345–405. 28. K. R. Gabriel and R. R. Sokal, A new statistical approach to geographic variation analysis, Systematic Zool. 18, 1969, 259–278. ´ 29. M. Schmitt and J. Mattioli, Morphologie Mathematique, Masson, Paris, 1993. 30. J. W. Brandt. Convergence and continuity criteria for discrete approximation of the continuous planar skeletons. CVGIP: Image Understanding, 59(1), 1994, 116–124. 31. D. Attali, P. Bertolino, and A. Montanvert, Using polyballs to approximate shapes and skeletons, in 12th International Conference on Pattern Recognition, Jerusalem, Israel, October 1994, pp. 626–628. 32. M. L. Connolly, Molecular interstitial skeleton. Computers Chem., 15(1), 1991, 37–45. 33. M.-P. Gascuel. An implicit formulation for precise contact modeling between ﬂexible solids. In SIGGRAPH’93, Anaheim, California, August 1993, pp. 313–320. 34. J. O’Rourke and N. Badler. Decomposition of three-dimensional objects into spheres. IEEE Trans. on PAMI, 1(3), July 1979, 295–305. 35. H. Edelsbrunner. The union of balls and its dual shape. In 9th Annual Symposium on Computational Geometry, San Diego, California, May 1993, pp. 218–229. 36. G. Sanniti di Baja and E. Thiel. (3,4)-weighted skeleton decomposition for pattern representation and description. Pattern Recognition 27, 1994, 1039–1049. 37. D. Attali, G. Sanniti di Baja, and E. Thiel. Pruning discrete and semicontinuous skeletons. In L. De Floriani C. Braccini and G. Ver-

edge, which joins two inner Voronoi vertices v and v , is included in the shape. Let the segment [ab] be the dual of the Voronoi edge [vv ] (Fig. 13b). From the previous, the line segments [va[, [vb[, [v a[, and [v b[ do not intersect the boundary of P. One can prove that any point in the inner area of the quadrilateral [vav b] is included in P. Consequently, the line segment [vv ] is included in P.

ACKNOWLEDGMENT
We are grateful to Dr. Etienne Bertin for making his software on Voronoi graphs available for our application.

REFERENCES
1. H. Blum, A transformation for extracting new descriptors of shape, in editor, Models for the Perception of Speech and Visual Form (W. Wathen-Dunn, Ed.), pp. 362–380, MIT Press, Cambridge, MA, 1967. 2. D. T. Lee, Medial axis transformation of a planar shape, IEEE Trans. PAMI 4(4), 1982, 363–369. 3. S. M. Pizer, W. R. Oliver, and S. H. Bloomberg, Hierarchical shape description via the multiresolution symmetric axis transform, IEEE Trans. PAMI 9(4), 1987, 505–511. 4. C. Arcelli and G. Sanniti di Baja, Euclidean skeleton via centre-ofmaximal-disc extraction, Image Vision Comput. 11(3), 1993, 163–173. 5. L. Vincent, Efﬁcient computation of various types of skeletons, in SPIE’s Medical Imaging V, San Jose, CA, February 1991, Vol. 1445. ` ´ ´ 6. J.-M. Chassery and A. Montanvert, Geometrie discrete en analyse ` d’images. Editions Hermes, Paris, 1991. 7. L. Lam, S.-W. Lee, and C. Y. Suen, Thinning methodologies—A comprehensive survey, IEEE Trans. PAMI 14(9), 1992, 869–885. 8. Y. Y. Zhang and P. S. P. Wang, Analytical comparison of thinning algorithms, Int. J. Pattern Recognit. Artif. Intell. 7, 1993, 1227–1246. 9. P. Srisuresh and S. N. Srihari, A shrinking algorithm for three dimensional objects, Comput. Vision Pattern Recognit. 1983, 392–393. 10. J. Mukherjee, B. N. Chatterji, and P. P. Das, Thinning of 3-D images using the safe point thinning algorithm (SPTA), Pattern Recognit. Lett. 10, 1989, 167–173. 11. F. Rolland, J.-M. Chassery, and A. Montanvert, 3D medial surfaces and 3D skeletons, in Visual Form-Analysis and Recognition (C. Arcelli, L. P. Cordella, and G. Sanniti di Baja, Eds.), pp. 443–450, Plenum, New York, 1992. 12. A. R. Cohen, B. Roysam, and J. N. Turner, Automated tracing and volume measurements of neurons from 3-D confocal ﬂuorescence microscopy data, J. Microsc. 173, 1994, 103–114. 13. V. Marion-Poty, Two methodologies to implement 3d thinning algorithms on distributed memory machines, in Parallel Image Analysis: Theory and Applications (L. S. Davis, K. Inoue, M, Nivat, A. Rosenfeld, and P. S. P. Wang, Eds.), pp. 193–212 [Machine Perception and Artiﬁcial Intelligence, Vol. 19], World Scientiﬁc, Singapore, 1996. 14. D. S. Fritsch, S. M. Pizer, B. S. Morse, D. H. Eberly, and A. Liu, The multiscale medial axis and its applications in image registration, Pattern Recognit. Lett. 15, 1994, 445–452. 15. R. Whitaker and G. Gerig, Vector-valued diffusion, in GeometryDriven Diffusion in Computer Vision (Bart M. ter Haar Romeny, Ed.), pp. 93–134 [Series on Computational Imaging and Vision, Vol. 1], Kluwer Academic, Amsterdam, 1994.

2D AND 3D CONTINUOUS SKELETONS nazza, editors, Lecture Notes in Computer Science, Image Analysis and Processing, Vol. 974, pp. 488–493. Springer-Verlag, 1995. Proc. of the 8th ICIAP. 38. R. Ogniewicz. A multiscale MAT from Voronoi diagrams: the skeleton-space and its application to shape description and decomposition. in Aspects of Visual Form Processing (C. Arcelli et al., Eds.), pp. 430–439, World Scientiﬁc, Singapore, 1994. 39. D. G. Kirkpatrick. Efﬁcient computation of continuous skeletons. In

273

20th Annual Symposium on Foundations of Computer Science, 1979, pp. 18–27. 40. D. Lavender, A. Bowyer, J. Davenport, A. Wallis, and J. Woodwark. Voronoi diagrams of set-theoretic solid models. IEEE Computer Graphics and Applications 12(5), 1992, 69–77. 41. E. Bertin and J.-M. Chassery, 3D generalized Voronoi diagram for a set of polyhedra, in Curves and Surfaces in Geometric Design (P. J. Laurent, A. le Mehaute, and L. L. Schumaker, Eds.), pp. 43–50, ´ Peters, Wellesley, MA, 1994.

